<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="8/23/2012 3:41:21 PM"
  DTS:CreationName="SSIS.Package.3"
  DTS:CreatorComputerName="MJENNIGS2-L7"
  DTS:CreatorName="CORPHQ\mjennings"
  DTS:DTSID="{E3938AA5-025E-46BB-826F-CA61BAB9D73D}"
  DTS:ExecutableType="SSIS.Package.3"
  DTS:LastModifiedProductVersion="11.0.5583.0"
  DTS:LocaleID="1033"
  DTS:ObjectName="Package"
  DTS:PackageType="5"
  DTS:VersionBuild="33"
  DTS:VersionGUID="{492F1DDD-E553-46AF-9236-B37DAB4B6BC0}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">6</DTS:Property>
  <DTS:ConnectionManagers>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[cronus\cronussql2000.MLHQ]"
      DTS:CreationName="OLEDB"
      DTS:DTSID="{AFFFDF1F-88E8-45B7-A323-F6E19ACE62BA}"
      DTS:ObjectName="cronus\cronussql2000.MLHQ">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=CRONUS\CRONUSSQL2000;User ID=ReportRunner;Initial Catalog=MLHQ;Provider=SQLOLEDB.1;Persist Security Info=True;Application Name=SSIS-Package-{AFFFDF1F-88E8-45B7-A323-F6E19ACE62BA}cronus\cronussql2000.master;">
          <DTS:Password
            DTS:Name="Password"
            Sensitive="1"
            Encrypted="1">AQAAANCMnd8BFdERjHoAwE/Cl+sBAAAAufOWFZqr40WfvRnghIe+iwAAAAAIAAAARABUAFMAAAADZgAAwAAAABAAAAAC1g0RxFIs8zjWu62h50g0AAAAAASAAACgAAAAEAAAAONxuvx6cGnYnci2aUK8TcwgAAAA2ytiMszweT/uuQlm1kNHt+ihWDCl/4eGLupQIK1N/4IUAAAAe6SwpYCjien0v/C3NEEFpyGXn/A</DTS:Password>
        </DTS:ConnectionManager>
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[DetailsNotExcluded]"
      DTS:CreationName="FLATFILE"
      DTS:DTSID="{A331109A-1A3C-444B-B15F-F9D0F65E40BB}"
      DTS:ObjectName="DetailsNotExcluded">
      <DTS:PropertyExpression
        DTS:Name="ConnectionString">@[User::FilePathDetailNotExcluded]</DTS:PropertyExpression>
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:Format="Delimited"
          DTS:LocaleID="1033"
          DTS:HeaderRowDelimiter="_x000D__x000A_"
          DTS:ColumnNamesInFirstDataRow="True"
          DTS:RowDelimiter=""
          DTS:TextQualifier="_x003C_none_x003E_"
          DTS:CodePage="1252"
          DTS:ConnectionString="M:\MessageHub\MenuLink\Outbox\MLInvoiceDetail_20170411071209.dat">
          <DTS:FlatFileColumns>
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="1"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Identifier"
              DTS:DTSID="{85B7972E-E126-48D6-8472-047EAEC17E90}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="15"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="RESTAURANT_NUM"
              DTS:DTSID="{C3F60012-B5FB-4E90-930A-BE7E1C5704F5}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="30"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="INVOICE_NUM"
              DTS:DTSID="{05BDC026-38AF-448C-AA4B-7FD93EB7F95D}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="100"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="LINE_DESC"
              DTS:DTSID="{C314E069-8009-41E1-A39A-3213CF7DFB75}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="60"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="VENDOR_ITEM_NUM"
              DTS:DTSID="{23E34A34-70A9-4484-A41C-D9ECE13BC95B}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:DataType="3"
              DTS:TextQualified="True"
              DTS:ObjectName="LINE_NUM"
              DTS:DTSID="{1C129AD5-7109-4C07-8AA8-6281E2B82FDD}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:DataType="131"
              DTS:DataPrecision="10"
              DTS:DataScale="2"
              DTS:TextQualified="True"
              DTS:ObjectName="QUANTITY"
              DTS:DTSID="{11364610-8936-413A-AB99-57EC2E050892}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:DataType="131"
              DTS:DataPrecision="10"
              DTS:DataScale="2"
              DTS:TextQualified="True"
              DTS:ObjectName="UNIT_PRICE"
              DTS:DTSID="{29F2AFD9-475C-4A99-949C-875E49158BDD}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:DataType="131"
              DTS:DataPrecision="10"
              DTS:DataScale="2"
              DTS:TextQualified="True"
              DTS:ObjectName="TOTAL_AMOUNT"
              DTS:DTSID="{8AAEBCCB-E7A4-49CA-B7D0-BD81B77715F0}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:DataType="3"
              DTS:TextQualified="True"
              DTS:ObjectName="GL_ACCOUNT"
              DTS:DTSID="{F9BB1D22-5592-4AF4-B0C2-932B909C647C}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:DataType="3"
              DTS:TextQualified="True"
              DTS:ObjectName="SUPPLIER_NUM"
              DTS:DTSID="{C3357003-AB11-4714-A1A6-515DD0F26D78}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x000D__x000A_"
              DTS:MaximumWidth="15"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="INVOICE_DATE"
              DTS:DTSID="{0CC12495-C09A-4D6C-A4BC-B83C477F2754}"
              DTS:CreationName="" />
          </DTS:FlatFileColumns>
        </DTS:ConnectionManager>
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[HeaderFileNotExcluded]"
      DTS:CreationName="FLATFILE"
      DTS:DTSID="{734D50BC-1D92-4212-B14F-CC1891D29FEC}"
      DTS:ObjectName="HeaderFileNotExcluded">
      <DTS:PropertyExpression
        DTS:Name="ConnectionString">@[User::FilePathHeaderNotExcluded]</DTS:PropertyExpression>
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:Format="Delimited"
          DTS:LocaleID="1033"
          DTS:HeaderRowDelimiter="_x000D__x000A_"
          DTS:ColumnNamesInFirstDataRow="True"
          DTS:RowDelimiter=""
          DTS:TextQualifier="_x003C_none_x003E_"
          DTS:CodePage="1252"
          DTS:ConnectionString="M:\MessageHub\MenuLink\Outbox\MLInvoiceHeader_20170411071209.dat">
          <DTS:FlatFileColumns>
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="1"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="Identifier"
              DTS:DTSID="{F139B4A0-EA61-4DE0-A645-7D4F7FD485E2}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:DataType="3"
              DTS:TextQualified="True"
              DTS:ObjectName="RESTAURANT_NUM"
              DTS:DTSID="{72EC7F4F-0C8B-45A9-8CE9-6F6CF912A6F7}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:MaximumWidth="30"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="INVOICE_NUM"
              DTS:DTSID="{8485131B-03C6-49AA-9373-0A677A22E158}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:DataType="3"
              DTS:TextQualified="True"
              DTS:ObjectName="SUPPLIER_NUM"
              DTS:DTSID="{E10BF1AD-C3A3-4631-9C4D-B6A6E990D787}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:DataType="3"
              DTS:TextQualified="True"
              DTS:ObjectName="PERIOD_NUM"
              DTS:DTSID="{ACA89F15-4FB7-4680-9D02-22D69DB091B8}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:DataType="3"
              DTS:TextQualified="True"
              DTS:ObjectName="WEEK_NUM"
              DTS:DTSID="{8372C693-8C29-4091-844E-22B0525E9689}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x007C_"
              DTS:DataType="6"
              DTS:TextQualified="True"
              DTS:ObjectName="INVOICE_TOTAL"
              DTS:DTSID="{66D8A8C0-8E6A-4C45-8DE6-D4CCBEA7743E}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x000D__x000A_"
              DTS:MaximumWidth="20"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="INVOICE_DATE"
              DTS:DTSID="{830F09C3-EE5E-4837-8EC2-22206D1D0B76}"
              DTS:CreationName="" />
          </DTS:FlatFileColumns>
        </DTS:ConnectionManager>
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[HQ-FinSQL-01.Interfaces.SSISUser]"
      DTS:CreationName="OLEDB"
      DTS:DTSID="{D7144BEA-7C02-4422-838C-427D46B824FC}"
      DTS:ObjectName="HQ-FinSQL-01.Interfaces.SSISUser">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=HQ-FinSQL-01;User ID=SSISUser;Initial Catalog=Interfaces;Provider=SQLNCLI11.1;Persist Security Info=True;Auto Translate=False;">
          <DTS:Password
            DTS:Name="Password"
            Sensitive="1"
            Encrypted="1">AQAAANCMnd8BFdERjHoAwE/Cl+sBAAAAufOWFZqr40WfvRnghIe+iwAAAAAIAAAARABUAFMAAAADZgAAwAAAABAAAACCYyyxwO9YNQmnp8/P00jrAAAAAASAAACgAAAAEAAAAOlg/npLj9ASgn/rYCuDNiUoAAAAKSuCU7KpbAd5sfRpoqaVfGX74/gnjy4E7kOVxzx3qsj2IBfNcD9MPxQAAADEMrD5vE+lsUrKWL4o0J43Rl5Z3Q</DTS:Password>
        </DTS:ConnectionManager>
      </DTS:ObjectData>
    </DTS:ConnectionManager>
  </DTS:ConnectionManagers>
  <DTS:PackageParameters>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:Description="Store ID as a 3 digit number with leading zeros"
      DTS:DTSID="{194C446D-1586-4ACE-AA6C-ECCA524AF480}"
      DTS:ObjectName="StoreID"
      DTS:Required="True">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">652</DTS:Property>
    </DTS:PackageParameter>
    <DTS:PackageParameter
      DTS:CreationName=""
      DTS:DataType="8"
      DTS:Description="Subperiod number as integer"
      DTS:DTSID="{87182805-053F-4C46-B589-2F0E4316F021}"
      DTS:ObjectName="Subperiod"
      DTS:Required="True">
      <DTS:Property
        DTS:DataType="8"
        DTS:Name="ParameterValue">794</DTS:Property>
    </DTS:PackageParameter>
  </DTS:PackageParameters>
  <DTS:Variables>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{F6C2BA80-64B1-4C12-9F10-B2D5756C25D5}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="REPLACE((DT_WSTR, 10)(DT_DBDATE)@[System::StartTime], &quot;-&quot;,&quot;&quot;) + REPLACE((DT_WSTR,10)(DT_DBTIME)@[System::StartTime], &quot;:&quot;, &quot;&quot;)"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="Date">
      <DTS:VariableValue
        DTS:DataType="8">20170411071209</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{BB986E91-0734-4907-8BF7-B61C85D275F4}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot;-- Detail recordset for INT037/047&#xA;&#xA;-- Declare Invoice Detail table variable&#xA;DECLARE @InvoiceDetail TABLE (&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dIdentifier varchar(1),&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dStoreID varchar(15),&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dInvoiceID varchar(30),&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dLineDesc varchar(100),&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dVendorItemID varchar(60),&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dLineNumber int,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dQuantity decimal(10,2),&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dUnitPrice decimal(10,2),&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dExtendedPrice decimal(10,2),&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dGLAccount int,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;hVendorID int,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dSubperiod varchar(10),&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dInvoiceDate datetime&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#xA;-- Populate detail table variable with all invoice line item detail for the specified subperiod&#xA;INSERT INTO @InvoiceDetail (dIdentifier,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dStoreID,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dInvoiceID,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dLineDesc,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dVendorItemID,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dLineNumber,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dQuantity,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dUnitPrice,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dExtendedPrice,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dGLAccount,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dSubperiod,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dInvoiceDate&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;&#x9;SELECT&#x9;'I',&#xA;&#x9;&#x9;&#x9;StoreID,&#xA;&#x9;&#x9;&#x9;InvoiceID,&#xA;&#x9;&#x9;&#x9;dLineDesc = CASE RawMaterialCatNum&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 1015000 THEN 'Payroll Cash Clearing'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 1065000 THEN 'Employee Advance - Merc. Comm.'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 2100000 THEN 'Gift Certificate Sales'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 5100000 THEN 'Meat'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 5110000 THEN 'Hamburger'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 5120000 THEN 'Poultry'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 5130000 THEN 'Seafood'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 5140000 THEN 'Produce'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 5150000 THEN 'French Fries'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 5160000 THEN 'Canned/Dry Goods'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 5170000 THEN 'Bread'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 5180000 THEN 'Dairy'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 5185000 THEN 'Cheese'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 5190000 THEN 'Fry Oil'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 5199000 THEN 'Rebates'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 5210000 THEN 'Liquor'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 5220000 THEN 'Wine'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 5230000 THEN 'Draft Beer'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 5240000 THEN 'Bottled Beer'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 5250000 THEN 'Bar Consumables'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 6050000 THEN 'Team Member Meetings'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 6255000 THEN 'Laundry Allowance'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7010000 THEN 'Kitchen Supplies'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7020000 THEN 'Restaurant Supplies'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7030000 THEN 'Glassware'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7040000 THEN 'China'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7050000 THEN 'Paper Supplies'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7060000 THEN 'Cleaning Supplies'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7070000 THEN 'Office Supplies'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7110000 THEN 'Laundry'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7120000 THEN 'Uniforms'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7140000 THEN 'Guest Complaints'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7150000 THEN 'Telephone'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7160000 THEN 'Dues and Subs'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7170000 THEN 'Recruitment Adv.'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7180000 THEN 'Cash Over and Short'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7190000 THEN 'Theft Loss &amp; Walkouts'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7200000 THEN 'Postage &amp; Freight'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7220000 THEN 'Janitorial &amp; Plant Maint.'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7221000 THEN 'Indoor Cleaning'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7222000 THEN 'Outdoor - Cleaning &amp; Landscape'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7222000 THEN 'Outdoor Cleaning &amp; Landscape'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7223000 THEN 'Pest Control'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7240000 THEN 'Travel'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7250000 THEN 'Warehousing &amp; Storage'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7310000 THEN 'R &amp; M - Building/FFE RPM'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7320000 THEN 'Preventive Maint Contracts'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7325000 THEN 'R &amp; M - Local Services'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7330000 THEN 'Comp &amp; Office Equip Maint.'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7440000 THEN 'Garbage'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7510000 THEN 'Leased Music'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7525000 THEN 'Plants Purchased'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7530000 THEN 'Bad Debts'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7540000 THEN 'Licenses'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7545000 THEN 'Security Services'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7550000 THEN 'City Business Tax'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7560000 THEN 'Small Equipment'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7580000 THEN 'Professional Services'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7590000 THEN 'Bank Charges'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7610000 THEN 'Marketing Supplies'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7620000 THEN 'Gift Cert - Promo'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7630000 THEN 'Local Store Marketing'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7630100 THEN 'Local Store Mktg Fundraiser'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7630100 THEN 'Local Store Mktg Fundraising'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7640000 THEN 'Advertising Contribribution'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7640000 THEN 'Advertising Contribution'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7660000 THEN 'Discount/Coupons - Rest'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7670000 THEN 'Discount/Coupons - Corp'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7710000 THEN 'Mercantile'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7720000 THEN 'Telephone Income'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7740000 THEN 'Amusement Income'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7750000 THEN 'Misc Income'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7820000 THEN 'Parking'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7840000 THEN 'Real Estate Taxes'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7870000 THEN 'Leased Equipment'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7900000 THEN 'Amort - Leasehold Imp'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7905000 THEN 'RRI Fee Expense'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7910000 THEN 'Amort - Organization'&#xA;&#x9;&#x9;&#x9;&#x9;END,&#xA;&#x9;&#x9;&#x9;VendorItemID,&#xA;&#x9;&#x9;&#x9;convert(int, (convert(decimal(17,12), InvoiceLineItem#))),&#xA;&#x9;&#x9;&#x9;round((convert(decimal(38,30), QuantityReceived)), 2),&#xA;&#x9;&#x9;&#x9;round((convert(decimal(38,30), PurchaseUnitPrice)), 2),&#xA;&#x9;&#x9;&#x9;round((convert(decimal(38,30), ExtendedPrice)), 2),&#xA;&#x9;&#x9;&#x9;convert(int, RawMaterialCatNum),&#xA;&#x9;&#x9;&#x9;Subperiod,&#xA;&#x9;&#x9;&#x9;InvoiceDate&#xA;&#x9;FROM&#x9;ST_InvoiceDetails &#xA;&#x9;WHERE&#x9;SubPeriod = &quot; + @[$Package::Subperiod]  + &quot; AND StoreID = '&quot; + @[$Package::StoreID]  + &quot;'&#xA;&#xA;-- Get the Supplier Number for each invoice from the header record&#xA;UPDATE @InvoiceDetail&#xA;SET hVendorID = (&#x9;SELECT convert(int, ih.VendorID)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;FROM ST_InvoiceHeaders ih&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE ih.StoreID = dStoreID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND ih.Subperiod = dSubperiod&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND ih.InvoiceID = dInvoiceID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;AND ih.InvoiceDate = dInvoiceDate)&#xA;&#xA;-- Generate the final recordset&#xA;SELECT&#x9;dIdentifier as [Identifier],&#xA;&#x9;&#x9;convert(int, dStoreID) as [RESTAURANT_NUM],&#xA;&#x9;&#x9;dInvoiceID as [INVOICE_NUM],&#xA;&#x9;&#x9;dLineDesc as [LINE_DESC],&#xA;&#x9;&#x9;dVendorItemID as [VENDOR_ITEM_NUM],&#xA;&#x9;&#x9;dLineNumber as [LINE_NUM],&#xA;&#x9;&#x9;dQuantity as [QUANTITY],&#xA;&#x9;&#x9;dUnitPrice as [UNIT_PRICE],&#xA;&#x9;&#x9;dExtendedPrice as [TOTAL_AMOUNT],&#xA;&#x9;&#x9;dGLAccount as [GL_ACCOUNT],&#xA;&#x9;&#x9;hVendorID as [SUPPLIER_NUM],&#xA;&#x9;&#x9;convert(varchar(15),dInvoiceDate, 101) as [INVOICE_DATE]&#xA;FROM&#x9;@InvoiceDetail &quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="DetailsQuery">
      <DTS:VariableValue
        DTS:DataType="8">-- Detail recordset for INT037/047

-- Declare Invoice Detail table variable
DECLARE @InvoiceDetail TABLE (
								dIdentifier varchar(1),
								dStoreID varchar(15),
								dInvoiceID varchar(30),
								dLineDesc varchar(100),
								dVendorItemID varchar(60),
								dLineNumber int,
								dQuantity decimal(10,2),
								dUnitPrice decimal(10,2),
								dExtendedPrice decimal(10,2),
								dGLAccount int,
								hVendorID int,
								dSubperiod varchar(10),
								dInvoiceDate datetime
								)

-- Populate detail table variable with all invoice line item detail for the specified subperiod
INSERT INTO @InvoiceDetail (dIdentifier,
								dStoreID,
								dInvoiceID,
								dLineDesc,
								dVendorItemID,
								dLineNumber,
								dQuantity,
								dUnitPrice,
								dExtendedPrice,
								dGLAccount,
								dSubperiod,
								dInvoiceDate
								)								
	SELECT	'I',
			StoreID,
			InvoiceID,
			dLineDesc = CASE RawMaterialCatNum
				WHEN 1015000 THEN 'Payroll Cash Clearing'
				WHEN 1065000 THEN 'Employee Advance - Merc. Comm.'
				WHEN 2100000 THEN 'Gift Certificate Sales'
				WHEN 5100000 THEN 'Meat'
				WHEN 5110000 THEN 'Hamburger'
				WHEN 5120000 THEN 'Poultry'
				WHEN 5130000 THEN 'Seafood'
				WHEN 5140000 THEN 'Produce'
				WHEN 5150000 THEN 'French Fries'
				WHEN 5160000 THEN 'Canned/Dry Goods'
				WHEN 5170000 THEN 'Bread'
				WHEN 5180000 THEN 'Dairy'
				WHEN 5185000 THEN 'Cheese'
				WHEN 5190000 THEN 'Fry Oil'
				WHEN 5199000 THEN 'Rebates'
				WHEN 5210000 THEN 'Liquor'
				WHEN 5220000 THEN 'Wine'
				WHEN 5230000 THEN 'Draft Beer'
				WHEN 5240000 THEN 'Bottled Beer'
				WHEN 5250000 THEN 'Bar Consumables'
				WHEN 6050000 THEN 'Team Member Meetings'
				WHEN 6255000 THEN 'Laundry Allowance'
				WHEN 7010000 THEN 'Kitchen Supplies'
				WHEN 7020000 THEN 'Restaurant Supplies'
				WHEN 7030000 THEN 'Glassware'
				WHEN 7040000 THEN 'China'
				WHEN 7050000 THEN 'Paper Supplies'
				WHEN 7060000 THEN 'Cleaning Supplies'
				WHEN 7070000 THEN 'Office Supplies'
				WHEN 7110000 THEN 'Laundry'
				WHEN 7120000 THEN 'Uniforms'
				WHEN 7140000 THEN 'Guest Complaints'
				WHEN 7150000 THEN 'Telephone'
				WHEN 7160000 THEN 'Dues and Subs'
				WHEN 7170000 THEN 'Recruitment Adv.'
				WHEN 7180000 THEN 'Cash Over and Short'
				WHEN 7190000 THEN 'Theft Loss &amp; Walkouts'
				WHEN 7200000 THEN 'Postage &amp; Freight'
				WHEN 7220000 THEN 'Janitorial &amp; Plant Maint.'
				WHEN 7221000 THEN 'Indoor Cleaning'
				WHEN 7222000 THEN 'Outdoor - Cleaning &amp; Landscape'
				WHEN 7222000 THEN 'Outdoor Cleaning &amp; Landscape'
				WHEN 7223000 THEN 'Pest Control'
				WHEN 7240000 THEN 'Travel'
				WHEN 7250000 THEN 'Warehousing &amp; Storage'
				WHEN 7310000 THEN 'R &amp; M - Building/FFE RPM'
				WHEN 7320000 THEN 'Preventive Maint Contracts'
				WHEN 7325000 THEN 'R &amp; M - Local Services'
				WHEN 7330000 THEN 'Comp &amp; Office Equip Maint.'
				WHEN 7440000 THEN 'Garbage'
				WHEN 7510000 THEN 'Leased Music'
				WHEN 7525000 THEN 'Plants Purchased'
				WHEN 7530000 THEN 'Bad Debts'
				WHEN 7540000 THEN 'Licenses'
				WHEN 7545000 THEN 'Security Services'
				WHEN 7550000 THEN 'City Business Tax'
				WHEN 7560000 THEN 'Small Equipment'
				WHEN 7580000 THEN 'Professional Services'
				WHEN 7590000 THEN 'Bank Charges'
				WHEN 7610000 THEN 'Marketing Supplies'
				WHEN 7620000 THEN 'Gift Cert - Promo'
				WHEN 7630000 THEN 'Local Store Marketing'
				WHEN 7630100 THEN 'Local Store Mktg Fundraiser'
				WHEN 7630100 THEN 'Local Store Mktg Fundraising'
				WHEN 7640000 THEN 'Advertising Contribribution'
				WHEN 7640000 THEN 'Advertising Contribution'
				WHEN 7660000 THEN 'Discount/Coupons - Rest'
				WHEN 7670000 THEN 'Discount/Coupons - Corp'
				WHEN 7710000 THEN 'Mercantile'
				WHEN 7720000 THEN 'Telephone Income'
				WHEN 7740000 THEN 'Amusement Income'
				WHEN 7750000 THEN 'Misc Income'
				WHEN 7820000 THEN 'Parking'
				WHEN 7840000 THEN 'Real Estate Taxes'
				WHEN 7870000 THEN 'Leased Equipment'
				WHEN 7900000 THEN 'Amort - Leasehold Imp'
				WHEN 7905000 THEN 'RRI Fee Expense'
				WHEN 7910000 THEN 'Amort - Organization'
				END,
			VendorItemID,
			convert(int, (convert(decimal(17,12), InvoiceLineItem#))),
			round((convert(decimal(38,30), QuantityReceived)), 2),
			round((convert(decimal(38,30), PurchaseUnitPrice)), 2),
			round((convert(decimal(38,30), ExtendedPrice)), 2),
			convert(int, RawMaterialCatNum),
			Subperiod,
			InvoiceDate
	FROM	ST_InvoiceDetails 
	WHERE	SubPeriod = 794 AND StoreID = '652'

-- Get the Supplier Number for each invoice from the header record
UPDATE @InvoiceDetail
SET hVendorID = (	SELECT convert(int, ih.VendorID)
					FROM ST_InvoiceHeaders ih
					WHERE ih.StoreID = dStoreID
					AND ih.Subperiod = dSubperiod
					AND ih.InvoiceID = dInvoiceID
					AND ih.InvoiceDate = dInvoiceDate)

-- Generate the final recordset
SELECT	dIdentifier as [Identifier],
		convert(int, dStoreID) as [RESTAURANT_NUM],
		dInvoiceID as [INVOICE_NUM],
		dLineDesc as [LINE_DESC],
		dVendorItemID as [VENDOR_ITEM_NUM],
		dLineNumber as [LINE_NUM],
		dQuantity as [QUANTITY],
		dUnitPrice as [UNIT_PRICE],
		dExtendedPrice as [TOTAL_AMOUNT],
		dGLAccount as [GL_ACCOUNT],
		hVendorID as [SUPPLIER_NUM],
		convert(varchar(15),dInvoiceDate, 101) as [INVOICE_DATE]
FROM	@InvoiceDetail </DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{F6C7BFC5-EDB0-4BE1-A484-499D23804E1E}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="DetailsRecordset">
      <DTS:VariableValue
        DTS:DataSubType="ManagedSerializable"
        DTS:DataType="13">
        <SOAP-ENV:Envelope xmlns:clr="http://schemas.microsoft.com/soap/encoding/clr/1.0" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
          <SOAP-ENV:Body>
            <xsd:anyType
              id="ref-1"></xsd:anyType>
          </SOAP-ENV:Body>
        </SOAP-ENV:Envelope>
      </DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{DFC1C4CC-BC51-482F-B05C-AF287AE3735C}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot;M:\\MessageHub\\MenuLink\\Outbox\\MLInvoiceDetail_&quot; + @Date + &quot;.dat&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="FilePathDetailNotExcluded">
      <DTS:VariableValue
        DTS:DataType="8">M:\MessageHub\MenuLink\Outbox\MLInvoiceDetail_20170411071209.dat</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{060DC1F8-0F7B-4D6A-B715-9F6647DE3ABE}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot;M:\\MessageHub\\MenuLink\\Outbox\\MLInvoiceHeader_&quot; + @Date + &quot;.dat&quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="FilePathHeaderNotExcluded">
      <DTS:VariableValue
        DTS:DataType="8">M:\MessageHub\MenuLink\Outbox\MLInvoiceHeader_20170411071209.dat</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{F3248A9F-F93F-4DF8-A741-1806AA4A81EC}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="HeaderRecordset">
      <DTS:VariableValue
        DTS:DataSubType="ManagedSerializable"
        DTS:DataType="13">
        <SOAP-ENV:Envelope xmlns:clr="http://schemas.microsoft.com/soap/encoding/clr/1.0" xmlns:SOAP-ENC="http://schemas.xmlsoap.org/soap/encoding/" xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">
          <SOAP-ENV:Body>
            <xsd:anyType
              id="ref-1"></xsd:anyType>
          </SOAP-ENV:Body>
        </SOAP-ENV:Envelope>
      </DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{EA4C6E18-09D9-483B-AC97-F30ADE24921F}"
      DTS:EvaluateAsExpression="True"
      DTS:Expression="&quot;-- Invoice Header Query for INT037/047&#xA;&#xA;-- Declare Invoice Header table variable&#xA;DECLARE @InvoiceHeader TABLE (&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;hIdentifier varchar(1),&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;hStoreID varchar(15),&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;hInvoiceID varchar(30),&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;hSupplierID varchar(20),&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;hPeriod int,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;hWeekNum int,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;hInvoiceAmount money,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;hCalculatedInvoiceAmount money,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;hInvoiceDate varchar(20)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#xA;-- Declare Invoice Detail table variable&#xA;DECLARE @InvoiceDetail TABLE (&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dIdentifier varchar(1),&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dStoreID varchar(15),&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dInvoiceID varchar(30),&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dLineDesc varchar(100),&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dVendorItemID varchar(60),&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dLineNumber int,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dQuantity decimal(10,2),&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dUnitPrice decimal(10,2),&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dExtendedPrice decimal(10,2),&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dGLAccount int,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dSubperiod varchar(10),&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;dInvoiceDate datetime&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#xA;&#xA;-- Populate header table variable with all invoice headers for the specified subperiod&#xA;INSERT INTO @InvoiceHeader (&#x9;hIdentifier,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;hStoreID,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;hInvoiceID,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;hSupplierID,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;hPeriod,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;hWeekNum,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;hInvoiceAmount,&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;hInvoiceDate&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;SELECT&#x9;'I',&#xA;&#x9;&#x9;&#x9;StoreID,&#xA;&#x9;&#x9;&#x9;InvoiceID,&#xA;&#x9;&#x9;&#x9;VendorID,&#xA;&#x9;&#x9;&#x9;ReportingPeriod#,&#xA;&#x9;&#x9;&#x9;[Week],&#xA;&#x9;&#x9;&#x9;convert(money, TotalAmountPayable) as [INVOICE_TOTAL],&#xA;&#x9;&#x9;&#x9;convert(varchar(15),InvoiceDate, 101) as [INVOICE_DATE]&#xA;&#x9;FROM&#x9;ST_InvoiceHeaders &#xA;&#x9;WHERE&#x9;SubPeriod = &quot; + @[$Package::Subperiod]  + &quot; AND StoreID = '&quot; + @[$Package::StoreID] + &quot;'&#xA;&#xA;-- Populate detail table variable with all invoice line item detail for the specified subperiod&#xA;INSERT INTO @InvoiceDetail&#xA;&#x9;SELECT&#x9;'I',&#xA;&#x9;&#x9;&#x9;StoreID,&#xA;&#x9;&#x9;&#x9;InvoiceID,&#xA;&#x9;&#x9;&#x9;dLineDesc = CASE RawMaterialCatNum&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 1015000 THEN 'Payroll Cash Clearing'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 1065000 THEN 'Employee Advance - Merc. Comm.'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 2100000 THEN 'Gift Certificate Sales'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 5100000 THEN 'Meat'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 5110000 THEN 'Hamburger'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 5120000 THEN 'Poultry'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 5130000 THEN 'Seafood'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 5140000 THEN 'Produce'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 5150000 THEN 'French Fries'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 5160000 THEN 'Canned/Dry Goods'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 5170000 THEN 'Bread'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 5180000 THEN 'Dairy'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 5185000 THEN 'Cheese'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 5190000 THEN 'Fry Oil'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 5199000 THEN 'Rebates'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 5210000 THEN 'Liquor'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 5220000 THEN 'Wine'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 5230000 THEN 'Draft Beer'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 5240000 THEN 'Bottled Beer'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 5250000 THEN 'Bar Consumables'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 6050000 THEN 'Team Member Meetings'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 6255000 THEN 'Laundry Allowance'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7010000 THEN 'Kitchen Supplies'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7020000 THEN 'Restaurant Supplies'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7030000 THEN 'Glassware'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7040000 THEN 'China'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7050000 THEN 'Paper Supplies'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7060000 THEN 'Cleaning Supplies'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7070000 THEN 'Office Supplies'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7110000 THEN 'Laundry'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7120000 THEN 'Uniforms'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7140000 THEN 'Guest Complaints'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7150000 THEN 'Telephone'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7160000 THEN 'Dues and Subs'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7170000 THEN 'Recruitment Adv.'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7180000 THEN 'Cash Over and Short'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7190000 THEN 'Theft Loss &amp; Walkouts'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7200000 THEN 'Postage &amp; Freight'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7220000 THEN 'Janitorial &amp; Plant Maint.'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7221000 THEN 'Indoor Cleaning'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7222000 THEN 'Outdoor - Cleaning &amp; Landscape'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7222000 THEN 'Outdoor Cleaning &amp; Landscape'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7223000 THEN 'Pest Control'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7240000 THEN 'Travel'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7250000 THEN 'Warehousing &amp; Storage'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7310000 THEN 'R &amp; M - Building/FFE RPM'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7320000 THEN 'Preventive Maint Contracts'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7325000 THEN 'R &amp; M - Local Services'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7330000 THEN 'Comp &amp; Office Equip Maint.'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7440000 THEN 'Garbage'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7510000 THEN 'Leased Music'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7525000 THEN 'Plants Purchased'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7530000 THEN 'Bad Debts'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7540000 THEN 'Licenses'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7545000 THEN 'Security Services'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7550000 THEN 'City Business Tax'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7560000 THEN 'Small Equipment'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7580000 THEN 'Professional Services'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7590000 THEN 'Bank Charges'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7610000 THEN 'Marketing Supplies'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7620000 THEN 'Gift Cert - Promo'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7630000 THEN 'Local Store Marketing'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7630100 THEN 'Local Store Mktg Fundraiser'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7630100 THEN 'Local Store Mktg Fundraising'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7640000 THEN 'Advertising Contribribution'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7640000 THEN 'Advertising Contribution'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7660000 THEN 'Discount/Coupons - Rest'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7670000 THEN 'Discount/Coupons - Corp'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7710000 THEN 'Mercantile'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7720000 THEN 'Telephone Income'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7740000 THEN 'Amusement Income'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7750000 THEN 'Misc Income'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7820000 THEN 'Parking'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7840000 THEN 'Real Estate Taxes'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7870000 THEN 'Leased Equipment'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7900000 THEN 'Amort - Leasehold Imp'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7905000 THEN 'RRI Fee Expense'&#xA;&#x9;&#x9;&#x9;&#x9;WHEN 7910000 THEN 'Amort - Organization'&#xA;&#x9;&#x9;&#x9;&#x9;END,&#xA;&#x9;&#x9;&#x9;VendorItemID,&#xA;&#x9;&#x9;&#x9;convert(int, (convert(decimal(17,12), InvoiceLineItem#))),&#xA;&#x9;&#x9;&#x9;round((convert(decimal(38,30), QuantityReceived)), 2),&#xA;&#x9;&#x9;&#x9;round((convert(decimal(38,30), PurchaseUnitPrice)), 2),&#xA;&#x9;&#x9;&#x9;round((convert(decimal(38,30), ExtendedPrice)), 2),&#xA;&#x9;&#x9;&#x9;convert(int, RawMaterialCatNum),&#xA;&#x9;&#x9;&#x9;Subperiod,&#xA;&#x9;&#x9;&#x9;InvoiceDate&#xA;&#x9;FROM&#x9;ST_InvoiceDetails &#xA;&#x9;WHERE&#x9;SubPeriod = &quot; + @[$Package::Subperiod]  + &quot; AND StoreID = '&quot; + @[$Package::StoreID] + &quot;'&#xA;&#xA;-- Calculate the invoice header total from the extended price of the line items in the detail&#xA;&#xA;-- Calculate totals for each invoice&#xA;UPDATE @InvoiceHeader&#xA;SET hCalculatedInvoiceAmount = (&#x9;SELECT sum(dExtendedPrice) &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;FROM @InvoiceDetail&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;WHERE hStoreID = dStoreID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND hInvoiceID = dInvoiceID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;AND hInvoiceDate = dInvoiceDate&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#xA;-- Remove Records with NULL hCalculatedInvoiceAmount&#xA;DELETE  FROM @InvoiceHeader&#xA;WHERE hCalculatedInvoiceAmount IS NULL AND hInvoiceID LIKE 'P%'&#xA;&#xA;&#xA;-- Final dataset&#xA;SELECT&#x9;hIdentifier as [Identifier],&#xA;&#x9;&#x9;convert(int, hStoreID) as [RESTAURANT_NUM],&#xA;&#x9;&#x9;hInvoiceID as [INVOICE_NUM],&#xA;&#x9;&#x9;convert(int, hSupplierID) as [SUPPLIER_NUM],&#xA;&#x9;&#x9;hPeriod as [PERIOD_NUM],&#xA;&#x9;&#x9;hWeekNum as [WEEK_NUM],&#xA;&#x9;&#x9;hCalculatedInvoiceAmount as [INVOICE_TOTAL],&#xA;&#x9;&#x9;hInvoiceDate as [INVOICE_DATE]&#xA; FROM&#x9;@InvoiceHeader &quot;"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="HeadersQuery">
      <DTS:VariableValue
        DTS:DataType="8">-- Invoice Header Query for INT037/047

-- Declare Invoice Header table variable
DECLARE @InvoiceHeader TABLE (
								hIdentifier varchar(1),
								hStoreID varchar(15),
								hInvoiceID varchar(30),
								hSupplierID varchar(20),
								hPeriod int,
								hWeekNum int,
								hInvoiceAmount money,
								hCalculatedInvoiceAmount money,
								hInvoiceDate varchar(20)
								)

-- Declare Invoice Detail table variable
DECLARE @InvoiceDetail TABLE (
								dIdentifier varchar(1),
								dStoreID varchar(15),
								dInvoiceID varchar(30),
								dLineDesc varchar(100),
								dVendorItemID varchar(60),
								dLineNumber int,
								dQuantity decimal(10,2),
								dUnitPrice decimal(10,2),
								dExtendedPrice decimal(10,2),
								dGLAccount int,
								dSubperiod varchar(10),
								dInvoiceDate datetime
								)


-- Populate header table variable with all invoice headers for the specified subperiod
INSERT INTO @InvoiceHeader (	hIdentifier,
								hStoreID,
								hInvoiceID,
								hSupplierID,
								hPeriod,
								hWeekNum,
								hInvoiceAmount,
								hInvoiceDate
								)
	SELECT	'I',
			StoreID,
			InvoiceID,
			VendorID,
			ReportingPeriod#,
			[Week],
			convert(money, TotalAmountPayable) as [INVOICE_TOTAL],
			convert(varchar(15),InvoiceDate, 101) as [INVOICE_DATE]
	FROM	ST_InvoiceHeaders 
	WHERE	SubPeriod = 794 AND StoreID = '652'

-- Populate detail table variable with all invoice line item detail for the specified subperiod
INSERT INTO @InvoiceDetail
	SELECT	'I',
			StoreID,
			InvoiceID,
			dLineDesc = CASE RawMaterialCatNum
				WHEN 1015000 THEN 'Payroll Cash Clearing'
				WHEN 1065000 THEN 'Employee Advance - Merc. Comm.'
				WHEN 2100000 THEN 'Gift Certificate Sales'
				WHEN 5100000 THEN 'Meat'
				WHEN 5110000 THEN 'Hamburger'
				WHEN 5120000 THEN 'Poultry'
				WHEN 5130000 THEN 'Seafood'
				WHEN 5140000 THEN 'Produce'
				WHEN 5150000 THEN 'French Fries'
				WHEN 5160000 THEN 'Canned/Dry Goods'
				WHEN 5170000 THEN 'Bread'
				WHEN 5180000 THEN 'Dairy'
				WHEN 5185000 THEN 'Cheese'
				WHEN 5190000 THEN 'Fry Oil'
				WHEN 5199000 THEN 'Rebates'
				WHEN 5210000 THEN 'Liquor'
				WHEN 5220000 THEN 'Wine'
				WHEN 5230000 THEN 'Draft Beer'
				WHEN 5240000 THEN 'Bottled Beer'
				WHEN 5250000 THEN 'Bar Consumables'
				WHEN 6050000 THEN 'Team Member Meetings'
				WHEN 6255000 THEN 'Laundry Allowance'
				WHEN 7010000 THEN 'Kitchen Supplies'
				WHEN 7020000 THEN 'Restaurant Supplies'
				WHEN 7030000 THEN 'Glassware'
				WHEN 7040000 THEN 'China'
				WHEN 7050000 THEN 'Paper Supplies'
				WHEN 7060000 THEN 'Cleaning Supplies'
				WHEN 7070000 THEN 'Office Supplies'
				WHEN 7110000 THEN 'Laundry'
				WHEN 7120000 THEN 'Uniforms'
				WHEN 7140000 THEN 'Guest Complaints'
				WHEN 7150000 THEN 'Telephone'
				WHEN 7160000 THEN 'Dues and Subs'
				WHEN 7170000 THEN 'Recruitment Adv.'
				WHEN 7180000 THEN 'Cash Over and Short'
				WHEN 7190000 THEN 'Theft Loss &amp; Walkouts'
				WHEN 7200000 THEN 'Postage &amp; Freight'
				WHEN 7220000 THEN 'Janitorial &amp; Plant Maint.'
				WHEN 7221000 THEN 'Indoor Cleaning'
				WHEN 7222000 THEN 'Outdoor - Cleaning &amp; Landscape'
				WHEN 7222000 THEN 'Outdoor Cleaning &amp; Landscape'
				WHEN 7223000 THEN 'Pest Control'
				WHEN 7240000 THEN 'Travel'
				WHEN 7250000 THEN 'Warehousing &amp; Storage'
				WHEN 7310000 THEN 'R &amp; M - Building/FFE RPM'
				WHEN 7320000 THEN 'Preventive Maint Contracts'
				WHEN 7325000 THEN 'R &amp; M - Local Services'
				WHEN 7330000 THEN 'Comp &amp; Office Equip Maint.'
				WHEN 7440000 THEN 'Garbage'
				WHEN 7510000 THEN 'Leased Music'
				WHEN 7525000 THEN 'Plants Purchased'
				WHEN 7530000 THEN 'Bad Debts'
				WHEN 7540000 THEN 'Licenses'
				WHEN 7545000 THEN 'Security Services'
				WHEN 7550000 THEN 'City Business Tax'
				WHEN 7560000 THEN 'Small Equipment'
				WHEN 7580000 THEN 'Professional Services'
				WHEN 7590000 THEN 'Bank Charges'
				WHEN 7610000 THEN 'Marketing Supplies'
				WHEN 7620000 THEN 'Gift Cert - Promo'
				WHEN 7630000 THEN 'Local Store Marketing'
				WHEN 7630100 THEN 'Local Store Mktg Fundraiser'
				WHEN 7630100 THEN 'Local Store Mktg Fundraising'
				WHEN 7640000 THEN 'Advertising Contribribution'
				WHEN 7640000 THEN 'Advertising Contribution'
				WHEN 7660000 THEN 'Discount/Coupons - Rest'
				WHEN 7670000 THEN 'Discount/Coupons - Corp'
				WHEN 7710000 THEN 'Mercantile'
				WHEN 7720000 THEN 'Telephone Income'
				WHEN 7740000 THEN 'Amusement Income'
				WHEN 7750000 THEN 'Misc Income'
				WHEN 7820000 THEN 'Parking'
				WHEN 7840000 THEN 'Real Estate Taxes'
				WHEN 7870000 THEN 'Leased Equipment'
				WHEN 7900000 THEN 'Amort - Leasehold Imp'
				WHEN 7905000 THEN 'RRI Fee Expense'
				WHEN 7910000 THEN 'Amort - Organization'
				END,
			VendorItemID,
			convert(int, (convert(decimal(17,12), InvoiceLineItem#))),
			round((convert(decimal(38,30), QuantityReceived)), 2),
			round((convert(decimal(38,30), PurchaseUnitPrice)), 2),
			round((convert(decimal(38,30), ExtendedPrice)), 2),
			convert(int, RawMaterialCatNum),
			Subperiod,
			InvoiceDate
	FROM	ST_InvoiceDetails 
	WHERE	SubPeriod = 794 AND StoreID = '652'

-- Calculate the invoice header total from the extended price of the line items in the detail

-- Calculate totals for each invoice
UPDATE @InvoiceHeader
SET hCalculatedInvoiceAmount = (	SELECT sum(dExtendedPrice) 
									FROM @InvoiceDetail
									WHERE hStoreID = dStoreID
										AND hInvoiceID = dInvoiceID
										AND hInvoiceDate = dInvoiceDate
								)

-- Remove Records with NULL hCalculatedInvoiceAmount
DELETE  FROM @InvoiceHeader
WHERE hCalculatedInvoiceAmount IS NULL AND hInvoiceID LIKE 'P%'


-- Final dataset
SELECT	hIdentifier as [Identifier],
		convert(int, hStoreID) as [RESTAURANT_NUM],
		hInvoiceID as [INVOICE_NUM],
		convert(int, hSupplierID) as [SUPPLIER_NUM],
		hPeriod as [PERIOD_NUM],
		hWeekNum as [WEEK_NUM],
		hCalculatedInvoiceAmount as [INVOICE_TOTAL],
		hInvoiceDate as [INVOICE_DATE]
 FROM	@InvoiceHeader </DTS:VariableValue>
    </DTS:Variable>
  </DTS:Variables>
  <DTS:LoggingOptions
    DTS:FilterKind="0"
    DTS:LoggingMode="1" />
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Get Invoice Details"
      DTS:CreationName="SSIS.Pipeline.3"
      DTS:Description="Data Flow Task"
      DTS:DTSID="{07DB4F65-5748-4DA2-B28E-F8DBE43016E0}"
      DTS:ExecutableType="SSIS.Pipeline.3"
      DTS:LocaleID="-1"
      DTS:ObjectName="Get Invoice Details"
      DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0"
        DTS:LoggingMode="1">
        <DTS:Property
          DTS:DataType="8"
          DTS:Name="EventFilter">1,7,OnError</DTS:Property>
        <DTS:Property
          DTS:EventName="OnError"
          DTS:Name="ColumnFilter">
          <DTS:Property
            DTS:Name="Computer">-1</DTS:Property>
          <DTS:Property
            DTS:Name="Operator">-1</DTS:Property>
          <DTS:Property
            DTS:Name="SourceName">-1</DTS:Property>
          <DTS:Property
            DTS:Name="SourceID">-1</DTS:Property>
          <DTS:Property
            DTS:Name="ExecutionID">-1</DTS:Property>
          <DTS:Property
            DTS:Name="MessageText">-1</DTS:Property>
          <DTS:Property
            DTS:Name="DataBytes">-1</DTS:Property>
        </DTS:Property>
      </DTS:LoggingOptions>
      <DTS:ObjectData>
        <pipeline
          version="1">
          <components>
            <component
              refId="Package\Get Invoice Details\Detail File Not Excluded"
              componentClassID="{8DA75FED-1B7C-407D-B2AD-2B24209CCCA4}"
              contactInfo="Flat File Destination;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;0"
              description="Flat File Destination"
              localeId="1033"
              name="Detail File Not Excluded">
              <properties>
                <property
                  dataType="System.Boolean"
                  description="Specifies whether the data will overwrite or append to the destination file."
                  name="Overwrite">true</property>
                <property
                  dataType="System.Null"
                  description="Specifies the text to write to the destination file before any data is written."
                  expressionType="Notify"
                  name="Header" />
              </properties>
              <connections>
                <connection
                  refId="Package\Get Invoice Details\Detail File Not Excluded.Connections[FlatFileConnection]"
                  connectionManagerID="Package.ConnectionManagers[DetailsNotExcluded]"
                  connectionManagerRefId="Package.ConnectionManagers[DetailsNotExcluded]"
                  name="FlatFileConnection" />
              </connections>
              <inputs>
                <input
                  refId="Package\Get Invoice Details\Detail File Not Excluded.Inputs[Flat File Destination Input]"
                  hasSideEffects="true"
                  name="Flat File Destination Input">
                  <inputColumns>
                    <inputColumn
                      refId="Package\Get Invoice Details\Detail File Not Excluded.Inputs[Flat File Destination Input].Columns[Identifier]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="1"
                      cachedName="Identifier"
                      externalMetadataColumnId="Package\Get Invoice Details\Detail File Not Excluded.Inputs[Flat File Destination Input].ExternalColumns[Identifier]"
                      lineageId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].Columns[Identifier]" />
                    <inputColumn
                      refId="Package\Get Invoice Details\Detail File Not Excluded.Inputs[Flat File Destination Input].Columns[RESTAURANT_NUM]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="15"
                      cachedName="RESTAURANT_NUM"
                      externalMetadataColumnId="Package\Get Invoice Details\Detail File Not Excluded.Inputs[Flat File Destination Input].ExternalColumns[RESTAURANT_NUM]"
                      lineageId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].Columns[RESTAURANT_NUM]" />
                    <inputColumn
                      refId="Package\Get Invoice Details\Detail File Not Excluded.Inputs[Flat File Destination Input].Columns[LINE_DESC]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="100"
                      cachedName="LINE_DESC"
                      externalMetadataColumnId="Package\Get Invoice Details\Detail File Not Excluded.Inputs[Flat File Destination Input].ExternalColumns[LINE_DESC]"
                      lineageId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].Columns[LINE_DESC]" />
                    <inputColumn
                      refId="Package\Get Invoice Details\Detail File Not Excluded.Inputs[Flat File Destination Input].Columns[VENDOR_ITEM_NUM]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="60"
                      cachedName="VENDOR_ITEM_NUM"
                      externalMetadataColumnId="Package\Get Invoice Details\Detail File Not Excluded.Inputs[Flat File Destination Input].ExternalColumns[VENDOR_ITEM_NUM]"
                      lineageId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].Columns[VENDOR_ITEM_NUM]" />
                    <inputColumn
                      refId="Package\Get Invoice Details\Detail File Not Excluded.Inputs[Flat File Destination Input].Columns[LINE_NUM]"
                      cachedDataType="i4"
                      cachedName="LINE_NUM"
                      externalMetadataColumnId="Package\Get Invoice Details\Detail File Not Excluded.Inputs[Flat File Destination Input].ExternalColumns[LINE_NUM]"
                      lineageId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].Columns[LINE_NUM]" />
                    <inputColumn
                      refId="Package\Get Invoice Details\Detail File Not Excluded.Inputs[Flat File Destination Input].Columns[QUANTITY]"
                      cachedDataType="numeric"
                      cachedName="QUANTITY"
                      cachedPrecision="10"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Get Invoice Details\Detail File Not Excluded.Inputs[Flat File Destination Input].ExternalColumns[QUANTITY]"
                      lineageId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].Columns[QUANTITY]" />
                    <inputColumn
                      refId="Package\Get Invoice Details\Detail File Not Excluded.Inputs[Flat File Destination Input].Columns[UNIT_PRICE]"
                      cachedDataType="numeric"
                      cachedName="UNIT_PRICE"
                      cachedPrecision="10"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Get Invoice Details\Detail File Not Excluded.Inputs[Flat File Destination Input].ExternalColumns[UNIT_PRICE]"
                      lineageId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].Columns[UNIT_PRICE]" />
                    <inputColumn
                      refId="Package\Get Invoice Details\Detail File Not Excluded.Inputs[Flat File Destination Input].Columns[TOTAL_AMOUNT]"
                      cachedDataType="numeric"
                      cachedName="TOTAL_AMOUNT"
                      cachedPrecision="10"
                      cachedScale="2"
                      externalMetadataColumnId="Package\Get Invoice Details\Detail File Not Excluded.Inputs[Flat File Destination Input].ExternalColumns[TOTAL_AMOUNT]"
                      lineageId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].Columns[TOTAL_AMOUNT]" />
                    <inputColumn
                      refId="Package\Get Invoice Details\Detail File Not Excluded.Inputs[Flat File Destination Input].Columns[GL_ACCOUNT]"
                      cachedDataType="i4"
                      cachedName="GL_ACCOUNT"
                      externalMetadataColumnId="Package\Get Invoice Details\Detail File Not Excluded.Inputs[Flat File Destination Input].ExternalColumns[GL_ACCOUNT]"
                      lineageId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].Columns[GL_ACCOUNT]" />
                    <inputColumn
                      refId="Package\Get Invoice Details\Detail File Not Excluded.Inputs[Flat File Destination Input].Columns[SUPPLIER_NUM]"
                      cachedDataType="i4"
                      cachedName="SUPPLIER_NUM"
                      externalMetadataColumnId="Package\Get Invoice Details\Detail File Not Excluded.Inputs[Flat File Destination Input].ExternalColumns[SUPPLIER_NUM]"
                      lineageId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].Columns[SUPPLIER_NUM]" />
                    <inputColumn
                      refId="Package\Get Invoice Details\Detail File Not Excluded.Inputs[Flat File Destination Input].Columns[INVOICE_DATE]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="15"
                      cachedName="INVOICE_DATE"
                      externalMetadataColumnId="Package\Get Invoice Details\Detail File Not Excluded.Inputs[Flat File Destination Input].ExternalColumns[INVOICE_DATE]"
                      lineageId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].Columns[INVOICE_DATE]" />
                    <inputColumn
                      refId="Package\Get Invoice Details\Detail File Not Excluded.Inputs[Flat File Destination Input].Columns[INVOICE_NUM]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="30"
                      cachedName="INVOICE_NUM"
                      externalMetadataColumnId="Package\Get Invoice Details\Detail File Not Excluded.Inputs[Flat File Destination Input].ExternalColumns[INVOICE_NUM]"
                      lineageId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].Columns[INVOICE_NUM]" />
                  </inputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Get Invoice Details\Detail File Not Excluded.Inputs[Flat File Destination Input].ExternalColumns[Identifier]"
                      codePage="1252"
                      dataType="str"
                      length="1"
                      name="Identifier" />
                    <externalMetadataColumn
                      refId="Package\Get Invoice Details\Detail File Not Excluded.Inputs[Flat File Destination Input].ExternalColumns[RESTAURANT_NUM]"
                      codePage="1252"
                      dataType="str"
                      length="15"
                      name="RESTAURANT_NUM" />
                    <externalMetadataColumn
                      refId="Package\Get Invoice Details\Detail File Not Excluded.Inputs[Flat File Destination Input].ExternalColumns[INVOICE_NUM]"
                      codePage="1252"
                      dataType="str"
                      length="30"
                      name="INVOICE_NUM" />
                    <externalMetadataColumn
                      refId="Package\Get Invoice Details\Detail File Not Excluded.Inputs[Flat File Destination Input].ExternalColumns[LINE_DESC]"
                      codePage="1252"
                      dataType="str"
                      length="100"
                      name="LINE_DESC" />
                    <externalMetadataColumn
                      refId="Package\Get Invoice Details\Detail File Not Excluded.Inputs[Flat File Destination Input].ExternalColumns[VENDOR_ITEM_NUM]"
                      codePage="1252"
                      dataType="str"
                      length="60"
                      name="VENDOR_ITEM_NUM" />
                    <externalMetadataColumn
                      refId="Package\Get Invoice Details\Detail File Not Excluded.Inputs[Flat File Destination Input].ExternalColumns[LINE_NUM]"
                      dataType="i4"
                      name="LINE_NUM" />
                    <externalMetadataColumn
                      refId="Package\Get Invoice Details\Detail File Not Excluded.Inputs[Flat File Destination Input].ExternalColumns[QUANTITY]"
                      dataType="numeric"
                      name="QUANTITY"
                      precision="10"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Get Invoice Details\Detail File Not Excluded.Inputs[Flat File Destination Input].ExternalColumns[UNIT_PRICE]"
                      dataType="numeric"
                      name="UNIT_PRICE"
                      precision="10"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Get Invoice Details\Detail File Not Excluded.Inputs[Flat File Destination Input].ExternalColumns[TOTAL_AMOUNT]"
                      dataType="numeric"
                      name="TOTAL_AMOUNT"
                      precision="10"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Get Invoice Details\Detail File Not Excluded.Inputs[Flat File Destination Input].ExternalColumns[GL_ACCOUNT]"
                      dataType="i4"
                      name="GL_ACCOUNT" />
                    <externalMetadataColumn
                      refId="Package\Get Invoice Details\Detail File Not Excluded.Inputs[Flat File Destination Input].ExternalColumns[SUPPLIER_NUM]"
                      dataType="i4"
                      name="SUPPLIER_NUM" />
                    <externalMetadataColumn
                      refId="Package\Get Invoice Details\Detail File Not Excluded.Inputs[Flat File Destination Input].ExternalColumns[INVOICE_DATE]"
                      codePage="1252"
                      dataType="str"
                      length="15"
                      name="INVOICE_DATE" />
                  </externalMetadataColumns>
                </input>
              </inputs>
            </component>
            <component
              refId="Package\Get Invoice Details\Detail Recordset"
              componentClassID="{165A526D-D5DE-47FF-96A6-F8274C19826B}"
              contactInfo="OLE DB Source;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;7"
              description="OLE DB Source"
              name="Detail Recordset"
              usesDispositions="true"
              version="7">
              <properties>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                  name="CommandTimeout">0</property>
                <property
                  dataType="System.String"
                  description="Specifies the name of the database object used to open a rowset."
                  name="OpenRowset"></property>
                <property
                  dataType="System.String"
                  description="Specifies the variable that contains the name of the database object used to open a rowset."
                  name="OpenRowsetVariable"></property>
                <property
                  dataType="System.String"
                  description="The SQL command to be executed."
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor, Microsoft.DataTransformationServices.Controls, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91">-- Detail recordset for INT037/047

-- Declare and set Store and Subperiod variables
DECLARE @StoreID varchar(3)
DECLARE @Subperiod int

SET @StoreID = '652'
SET @Subperiod = 794

-- Declare Invoice Detail table variable
DECLARE @InvoiceDetail TABLE (
								dIdentifier varchar(1),
								dStoreID varchar(15),
								dInvoiceID varchar(30),
								dLineDesc varchar(100),
								dVendorItemID varchar(60),
								dLineNumber int,
								dQuantity decimal(10,2),
								dUnitPrice decimal(10,2),
								dExtendedPrice decimal(10,2),
								dGLAccount int,
								hVendorID int,
								dSubperiod varchar(10),
								dInvoiceDate datetime
								)

-- Populate detail table variable with all invoice line item detail for the specified subperiod
INSERT INTO @InvoiceDetail (dIdentifier,
								dStoreID,
								dInvoiceID,
								dLineDesc,
								dVendorItemID,
								dLineNumber,
								dQuantity,
								dUnitPrice,
								dExtendedPrice,
								dGLAccount,
								dSubperiod,
								dInvoiceDate
								)								
	SELECT	'I',
			StoreID,
			InvoiceID,
			dLineDesc = CASE RawMaterialCatNum
				WHEN 1015000 THEN 'Payroll Cash Clearing'
				WHEN 1065000 THEN 'Employee Advance - Merc. Comm.'
				WHEN 2100000 THEN 'Gift Certificate Sales'
				WHEN 5100000 THEN 'Meat'
				WHEN 5110000 THEN 'Hamburger'
				WHEN 5120000 THEN 'Poultry'
				WHEN 5130000 THEN 'Seafood'
				WHEN 5140000 THEN 'Produce'
				WHEN 5150000 THEN 'French Fries'
				WHEN 5160000 THEN 'Canned/Dry Goods'
				WHEN 5170000 THEN 'Bread'
				WHEN 5180000 THEN 'Dairy'
				WHEN 5185000 THEN 'Cheese'
				WHEN 5190000 THEN 'Fry Oil'
				WHEN 5199000 THEN 'Rebates'
				WHEN 5210000 THEN 'Liquor'
				WHEN 5220000 THEN 'Wine'
				WHEN 5230000 THEN 'Draft Beer'
				WHEN 5240000 THEN 'Bottled Beer'
				WHEN 5250000 THEN 'Bar Consumables'
				WHEN 6050000 THEN 'Team Member Meetings'
				WHEN 6255000 THEN 'Laundry Allowance'
				WHEN 7010000 THEN 'Kitchen Supplies'
				WHEN 7020000 THEN 'Restaurant Supplies'
				WHEN 7030000 THEN 'Glassware'
				WHEN 7040000 THEN 'China'
				WHEN 7050000 THEN 'Paper Supplies'
				WHEN 7060000 THEN 'Cleaning Supplies'
				WHEN 7070000 THEN 'Office Supplies'
				WHEN 7110000 THEN 'Laundry'
				WHEN 7120000 THEN 'Uniforms'
				WHEN 7140000 THEN 'Guest Complaints'
				WHEN 7150000 THEN 'Telephone'
				WHEN 7160000 THEN 'Dues and Subs'
				WHEN 7170000 THEN 'Recruitment Adv.'
				WHEN 7180000 THEN 'Cash Over and Short'
				WHEN 7190000 THEN 'Theft Loss &amp; Walkouts'
				WHEN 7200000 THEN 'Postage &amp; Freight'
				WHEN 7220000 THEN 'Janitorial &amp; Plant Maint.'
				WHEN 7221000 THEN 'Indoor Cleaning'
				WHEN 7222000 THEN 'Outdoor - Cleaning &amp; Landscape'
				WHEN 7222000 THEN 'Outdoor Cleaning &amp; Landscape'
				WHEN 7223000 THEN 'Pest Control'
				WHEN 7240000 THEN 'Travel'
				WHEN 7250000 THEN 'Warehousing &amp; Storage'
				WHEN 7310000 THEN 'R &amp; M - Building/FFE RPM'
				WHEN 7320000 THEN 'Preventive Maint Contracts'
				WHEN 7325000 THEN 'R &amp; M - Local Services'
				WHEN 7330000 THEN 'Comp &amp; Office Equip Maint.'
				WHEN 7440000 THEN 'Garbage'
				WHEN 7510000 THEN 'Leased Music'
				WHEN 7525000 THEN 'Plants Purchased'
				WHEN 7530000 THEN 'Bad Debts'
				WHEN 7540000 THEN 'Licenses'
				WHEN 7545000 THEN 'Security Services'
				WHEN 7550000 THEN 'City Business Tax'
				WHEN 7560000 THEN 'Small Equipment'
				WHEN 7580000 THEN 'Professional Services'
				WHEN 7590000 THEN 'Bank Charges'
				WHEN 7610000 THEN 'Marketing Supplies'
				WHEN 7620000 THEN 'Gift Cert - Promo'
				WHEN 7630000 THEN 'Local Store Marketing'
				WHEN 7630100 THEN 'Local Store Mktg Fundraiser'
				WHEN 7630100 THEN 'Local Store Mktg Fundraising'
				WHEN 7640000 THEN 'Advertising Contribribution'
				WHEN 7640000 THEN 'Advertising Contribution'
				WHEN 7660000 THEN 'Discount/Coupons - Rest'
				WHEN 7670000 THEN 'Discount/Coupons - Corp'
				WHEN 7710000 THEN 'Mercantile'
				WHEN 7720000 THEN 'Telephone Income'
				WHEN 7740000 THEN 'Amusement Income'
				WHEN 7750000 THEN 'Misc Income'
				WHEN 7820000 THEN 'Parking'
				WHEN 7840000 THEN 'Real Estate Taxes'
				WHEN 7870000 THEN 'Leased Equipment'
				WHEN 7900000 THEN 'Amort - Leasehold Imp'
				WHEN 7905000 THEN 'RRI Fee Expense'
				WHEN 7910000 THEN 'Amort - Organization'
				END,
			VendorItemID,
			convert(int, (convert(decimal(17,12), InvoiceLineItem#))),
			round((convert(decimal(38,30), QuantityReceived)), 2),
			round((convert(decimal(38,30), PurchaseUnitPrice)), 2),
			round((convert(decimal(38,30), ExtendedPrice)), 2),
			convert(int, RawMaterialCatNum),
			Subperiod,
			InvoiceDate
	FROM	ST_InvoiceDetails 
	WHERE	SubPeriod = @Subperiod AND StoreID = @StoreID

-- Get the Supplier Number for each invoice from the header record
UPDATE @InvoiceDetail
SET hVendorID = (	SELECT convert(int, ih.VendorID)
					FROM ST_InvoiceHeaders ih
					WHERE ih.StoreID = dStoreID
					AND ih.Subperiod = dSubperiod
					AND ih.InvoiceID = dInvoiceID
					AND ih.InvoiceDate = dInvoiceDate)

-- Generate the final recordset
SELECT	dIdentifier as [Identifier],
		convert(int, dStoreID) as [RESTAURANT_NUM],
		dInvoiceID as [INVOICE_NUM],
		dLineDesc as [LINE_DESC],
		dVendorItemID as [VENDOR_ITEM_NUM],
		dLineNumber as [LINE_NUM],
		dQuantity as [QUANTITY],
		dUnitPrice as [UNIT_PRICE],
		dExtendedPrice as [TOTAL_AMOUNT],
		dGLAccount as [GL_ACCOUNT],
		hVendorID as [SUPPLIER_NUM],
		convert(varchar(15),dInvoiceDate, 101) as [INVOICE_DATE]
FROM	@InvoiceDetail</property>
                <property
                  dataType="System.String"
                  description="The variable that contains the SQL command to be executed."
                  name="SqlCommandVariable">User::DetailsQuery</property>
                <property
                  dataType="System.Int32"
                  description="Specifies the column code page to use when code page information is unavailable from the data source."
                  name="DefaultCodePage">1252</property>
                <property
                  dataType="System.Boolean"
                  description="Forces the use of the DefaultCodePage property value when describing character data."
                  name="AlwaysUseDefaultCodePage">false</property>
                <property
                  dataType="System.Int32"
                  description="Specifies the mode used to access the database."
                  name="AccessMode"
                  typeConverter="AccessMode">3</property>
                <property
                  dataType="System.String"
                  description="The mappings between the parameters in the SQL command and variables."
                  name="ParameterMapping"></property>
              </properties>
              <connections>
                <connection
                  refId="Package\Get Invoice Details\Detail Recordset.Connections[OleDbConnection]"
                  connectionManagerID="Package.ConnectionManagers[cronus\cronussql2000.MLHQ]"
                  connectionManagerRefId="Package.ConnectionManagers[cronus\cronussql2000.MLHQ]"
                  description="The OLE DB runtime connection used to access the database."
                  name="OleDbConnection" />
              </connections>
              <outputs>
                <output
                  refId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output]"
                  name="OLE DB Source Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].Columns[Identifier]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].ExternalColumns[Identifier]"
                      length="1"
                      lineageId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].Columns[Identifier]"
                      name="Identifier"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].Columns[RESTAURANT_NUM]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].ExternalColumns[RESTAURANT_NUM]"
                      length="15"
                      lineageId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].Columns[RESTAURANT_NUM]"
                      name="RESTAURANT_NUM"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].Columns[INVOICE_NUM]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].ExternalColumns[INVOICE_NUM]"
                      length="30"
                      lineageId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].Columns[INVOICE_NUM]"
                      name="INVOICE_NUM"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].Columns[LINE_DESC]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].ExternalColumns[LINE_DESC]"
                      length="100"
                      lineageId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].Columns[LINE_DESC]"
                      name="LINE_DESC"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].Columns[VENDOR_ITEM_NUM]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].ExternalColumns[VENDOR_ITEM_NUM]"
                      length="60"
                      lineageId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].Columns[VENDOR_ITEM_NUM]"
                      name="VENDOR_ITEM_NUM"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].Columns[LINE_NUM]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].ExternalColumns[LINE_NUM]"
                      lineageId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].Columns[LINE_NUM]"
                      name="LINE_NUM"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].Columns[QUANTITY]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].ExternalColumns[QUANTITY]"
                      lineageId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].Columns[QUANTITY]"
                      name="QUANTITY"
                      precision="10"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].Columns[UNIT_PRICE]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].ExternalColumns[UNIT_PRICE]"
                      lineageId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].Columns[UNIT_PRICE]"
                      name="UNIT_PRICE"
                      precision="10"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].Columns[TOTAL_AMOUNT]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].ExternalColumns[TOTAL_AMOUNT]"
                      lineageId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].Columns[TOTAL_AMOUNT]"
                      name="TOTAL_AMOUNT"
                      precision="10"
                      scale="2"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].Columns[GL_ACCOUNT]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].ExternalColumns[GL_ACCOUNT]"
                      lineageId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].Columns[GL_ACCOUNT]"
                      name="GL_ACCOUNT"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].Columns[SUPPLIER_NUM]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].ExternalColumns[SUPPLIER_NUM]"
                      lineageId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].Columns[SUPPLIER_NUM]"
                      name="SUPPLIER_NUM"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].Columns[INVOICE_DATE]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].ExternalColumns[INVOICE_DATE]"
                      length="15"
                      lineageId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].Columns[INVOICE_DATE]"
                      name="INVOICE_DATE"
                      truncationRowDisposition="FailComponent" />
                  </outputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].ExternalColumns[Identifier]"
                      codePage="1252"
                      dataType="str"
                      length="1"
                      name="Identifier" />
                    <externalMetadataColumn
                      refId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].ExternalColumns[RESTAURANT_NUM]"
                      dataType="i4"
                      name="RESTAURANT_NUM" />
                    <externalMetadataColumn
                      refId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].ExternalColumns[INVOICE_NUM]"
                      codePage="1252"
                      dataType="str"
                      length="30"
                      name="INVOICE_NUM" />
                    <externalMetadataColumn
                      refId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].ExternalColumns[LINE_DESC]"
                      codePage="1252"
                      dataType="str"
                      length="100"
                      name="LINE_DESC" />
                    <externalMetadataColumn
                      refId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].ExternalColumns[VENDOR_ITEM_NUM]"
                      codePage="1252"
                      dataType="str"
                      length="60"
                      name="VENDOR_ITEM_NUM" />
                    <externalMetadataColumn
                      refId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].ExternalColumns[LINE_NUM]"
                      dataType="i4"
                      name="LINE_NUM" />
                    <externalMetadataColumn
                      refId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].ExternalColumns[QUANTITY]"
                      dataType="numeric"
                      name="QUANTITY"
                      precision="10"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].ExternalColumns[UNIT_PRICE]"
                      dataType="numeric"
                      name="UNIT_PRICE"
                      precision="10"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].ExternalColumns[TOTAL_AMOUNT]"
                      dataType="numeric"
                      name="TOTAL_AMOUNT"
                      precision="10"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].ExternalColumns[GL_ACCOUNT]"
                      dataType="i4"
                      name="GL_ACCOUNT" />
                    <externalMetadataColumn
                      refId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].ExternalColumns[SUPPLIER_NUM]"
                      dataType="i4"
                      name="SUPPLIER_NUM" />
                    <externalMetadataColumn
                      refId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].ExternalColumns[INVOICE_DATE]"
                      codePage="1252"
                      dataType="str"
                      length="15"
                      name="INVOICE_DATE" />
                  </externalMetadataColumns>
                </output>
                <output
                  refId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Error Output]"
                  isErrorOut="true"
                  name="OLE DB Source Error Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Error Output].Columns[Identifier]"
                      codePage="1252"
                      dataType="str"
                      length="1"
                      lineageId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Error Output].Columns[Identifier]"
                      name="Identifier" />
                    <outputColumn
                      refId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Error Output].Columns[RESTAURANT_NUM]"
                      dataType="i4"
                      lineageId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Error Output].Columns[RESTAURANT_NUM]"
                      name="RESTAURANT_NUM" />
                    <outputColumn
                      refId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Error Output].Columns[INVOICE_NUM]"
                      codePage="1252"
                      dataType="str"
                      length="30"
                      lineageId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Error Output].Columns[INVOICE_NUM]"
                      name="INVOICE_NUM" />
                    <outputColumn
                      refId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Error Output].Columns[LINE_DESC]"
                      codePage="1252"
                      dataType="str"
                      length="100"
                      lineageId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Error Output].Columns[LINE_DESC]"
                      name="LINE_DESC" />
                    <outputColumn
                      refId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Error Output].Columns[VENDOR_ITEM_NUM]"
                      codePage="1252"
                      dataType="str"
                      length="60"
                      lineageId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Error Output].Columns[VENDOR_ITEM_NUM]"
                      name="VENDOR_ITEM_NUM" />
                    <outputColumn
                      refId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Error Output].Columns[LINE_NUM]"
                      dataType="i4"
                      lineageId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Error Output].Columns[LINE_NUM]"
                      name="LINE_NUM" />
                    <outputColumn
                      refId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Error Output].Columns[QUANTITY]"
                      dataType="numeric"
                      lineageId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Error Output].Columns[QUANTITY]"
                      name="QUANTITY"
                      precision="10"
                      scale="2" />
                    <outputColumn
                      refId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Error Output].Columns[UNIT_PRICE]"
                      dataType="numeric"
                      lineageId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Error Output].Columns[UNIT_PRICE]"
                      name="UNIT_PRICE"
                      precision="10"
                      scale="2" />
                    <outputColumn
                      refId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Error Output].Columns[TOTAL_AMOUNT]"
                      dataType="numeric"
                      lineageId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Error Output].Columns[TOTAL_AMOUNT]"
                      name="TOTAL_AMOUNT"
                      precision="10"
                      scale="2" />
                    <outputColumn
                      refId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Error Output].Columns[GL_ACCOUNT]"
                      dataType="i4"
                      lineageId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Error Output].Columns[GL_ACCOUNT]"
                      name="GL_ACCOUNT" />
                    <outputColumn
                      refId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Error Output].Columns[SUPPLIER_NUM]"
                      dataType="i4"
                      lineageId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Error Output].Columns[SUPPLIER_NUM]"
                      name="SUPPLIER_NUM" />
                    <outputColumn
                      refId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Error Output].Columns[INVOICE_DATE]"
                      codePage="1252"
                      dataType="str"
                      length="15"
                      lineageId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Error Output].Columns[INVOICE_DATE]"
                      name="INVOICE_DATE" />
                    <outputColumn
                      refId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
            <component
              refId="Package\Get Invoice Details\Remove Existing JDE Invoices"
              componentClassID="{671046B0-AA63-4C9F-90E4-C06E0B710CE3}"
              contactInfo="Lookup;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;6"
              description="Joins additional columns to the data flow by looking up values in a table. For example, join to the 'employee id' column the employees table to get 'hire date' and 'employee name'. We recommend this transformation when the lookup table can fit into memory."
              name="Remove Existing JDE Invoices"
              usesDispositions="true"
              version="6">
              <properties>
                <property
                  dataType="System.String"
                  description="Specifies the SQL statement that generates the lookup table."
                  expressionType="Notify"
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor, Microsoft.DataTransformationServices.Controls, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91">select * from [MenuLink].[INT037JDEReference]</property>
                <property
                  dataType="System.String"
                  description="Specifies a SQL statement that uses parameters to generate the lookup table."
                  expressionType="Notify"
                  name="SqlCommandParam"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor, Microsoft.DataTransformationServices.Controls, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91">select * from (select * from [MenuLink].[INT037JDEReference]) [refTable]
where [refTable].[JDESupplierInvoiceID] = ? and [refTable].[JDESupplierID] = ?</property>
                <property
                  dataType="System.Int32"
                  description="Specifies the type of connection used to access the reference dataset."
                  name="ConnectionType"
                  typeConverter="LookupConnectionType">0</property>
                <property
                  dataType="System.Int32"
                  description="Specifies the cache type of the lookup table."
                  name="CacheType"
                  typeConverter="CacheType">0</property>
                <property
                  dataType="System.Int32"
                  description="Specifies how the Lookup transformation handles rows without matching entries in the reference data set."
                  name="NoMatchBehavior"
                  typeConverter="LookupNoMatchBehavior">1</property>
                <property
                  dataType="System.Int32"
                  description="Specifies the percentage of the cache that is allocated for rows with no matching entries in the reference dataset."
                  name="NoMatchCachePercentage">0</property>
                <property
                  dataType="System.Int32"
                  description="Maximum Memory Usage for Reference Cache on a 32 bit platform."
                  name="MaxMemoryUsage">25</property>
                <property
                  dataType="System.Int64"
                  description="Maximum Memory Usage for Reference Cache on a 64 bit platform."
                  name="MaxMemoryUsage64">25</property>
                <property
                  dataType="System.String"
                  description="Indicates whether to reference metadata in an XML format."
                  name="ReferenceMetadataXml">&lt;referenceMetadata&gt;&lt;referenceColumns&gt;&lt;referenceColumn name="JDESupplierID" dataType="DT_I4" length="0" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="JDESupplierInvoiceID" dataType="DT_STR" length="50" precision="0" scale="0" codePage="1252"/&gt;&lt;/referenceColumns&gt;&lt;/referenceMetadata&gt;</property>
                <property
                  containsID="true"
                  dataType="System.String"
                  description="Specifies the list of lineage identifiers that map to the parameters that the SQL statement in the SQLCommand property uses. Entries in the list are separated by semicolons."
                  name="ParameterMap">#{Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].Columns[INVOICE_NUM]};#{Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].Columns[SUPPLIER_NUM]};</property>
                <property
                  dataType="System.Int32"
                  description="Specifies the column code page to use when code page information is unavailable from the data source."
                  name="DefaultCodePage">1252</property>
                <property
                  dataType="System.Boolean"
                  description="Determines whether duplicate keys in the reference data should be treated as errors when full cache mode is used."
                  name="TreatDuplicateKeysAsError">false</property>
              </properties>
              <connections>
                <connection
                  refId="Package\Get Invoice Details\Remove Existing JDE Invoices.Connections[OleDbConnection]"
                  connectionManagerID="Package.ConnectionManagers[HQ-FinSQL-01.Interfaces.SSISUser]"
                  connectionManagerRefId="Package.ConnectionManagers[HQ-FinSQL-01.Interfaces.SSISUser]"
                  description="Connection manager used to access lookup data."
                  name="OleDbConnection" />
              </connections>
              <inputs>
                <input
                  refId="Package\Get Invoice Details\Remove Existing JDE Invoices.Inputs[Lookup Input]"
                  name="Lookup Input">
                  <inputColumns>
                    <inputColumn
                      refId="Package\Get Invoice Details\Remove Existing JDE Invoices.Inputs[Lookup Input].Columns[INVOICE_NUM]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="30"
                      cachedName="INVOICE_NUM"
                      lineageId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].Columns[INVOICE_NUM]">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Specifies the column in the reference table that a column joins."
                          name="JoinToReferenceColumn">JDESupplierInvoiceID</property>
                        <property
                          dataType="System.Null"
                          description="Specifies the column in the reference table from which a column is copied."
                          name="CopyFromReferenceColumn" />
                      </properties>
                    </inputColumn>
                    <inputColumn
                      refId="Package\Get Invoice Details\Remove Existing JDE Invoices.Inputs[Lookup Input].Columns[SUPPLIER_NUM]"
                      cachedDataType="i4"
                      cachedName="SUPPLIER_NUM"
                      lineageId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output].Columns[SUPPLIER_NUM]">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Specifies the column in the reference table that a column joins."
                          name="JoinToReferenceColumn">JDESupplierID</property>
                        <property
                          dataType="System.Null"
                          description="Specifies the column in the reference table from which a column is copied."
                          name="CopyFromReferenceColumn" />
                      </properties>
                    </inputColumn>
                  </inputColumns>
                  <externalMetadataColumns />
                </input>
              </inputs>
              <outputs>
                <output
                  refId="Package\Get Invoice Details\Remove Existing JDE Invoices.Outputs[Lookup Match Output]"
                  errorOrTruncationOperation="Lookup"
                  exclusionGroup="1"
                  name="Lookup Match Output"
                  synchronousInputId="Package\Get Invoice Details\Remove Existing JDE Invoices.Inputs[Lookup Input]">
                  <externalMetadataColumns />
                </output>
                <output
                  refId="Package\Get Invoice Details\Remove Existing JDE Invoices.Outputs[Lookup No Match Output]"
                  description="The Lookup output that handles rows with no matching entries in the reference dataset. Use this output when the NoMatchBehavior property is set to &quot;Send rows with no matching entries to the no match output.&quot;"
                  exclusionGroup="1"
                  name="Lookup No Match Output"
                  synchronousInputId="Package\Get Invoice Details\Remove Existing JDE Invoices.Inputs[Lookup Input]">
                  <externalMetadataColumns />
                </output>
                <output
                  refId="Package\Get Invoice Details\Remove Existing JDE Invoices.Outputs[Lookup Error Output]"
                  exclusionGroup="1"
                  isErrorOut="true"
                  name="Lookup Error Output"
                  synchronousInputId="Package\Get Invoice Details\Remove Existing JDE Invoices.Inputs[Lookup Input]">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Get Invoice Details\Remove Existing JDE Invoices.Outputs[Lookup Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Get Invoice Details\Remove Existing JDE Invoices.Outputs[Lookup Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Get Invoice Details\Remove Existing JDE Invoices.Outputs[Lookup Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Get Invoice Details\Remove Existing JDE Invoices.Outputs[Lookup Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
          </components>
          <paths>
            <path
              refId="Package\Get Invoice Details.Paths[Lookup No Match Output]"
              endId="Package\Get Invoice Details\Detail File Not Excluded.Inputs[Flat File Destination Input]"
              name="Lookup No Match Output"
              startId="Package\Get Invoice Details\Remove Existing JDE Invoices.Outputs[Lookup No Match Output]" />
            <path
              refId="Package\Get Invoice Details.Paths[OLE DB Source Output]"
              endId="Package\Get Invoice Details\Remove Existing JDE Invoices.Inputs[Lookup Input]"
              name="OLE DB Source Output"
              startId="Package\Get Invoice Details\Detail Recordset.Outputs[OLE DB Source Output]" />
          </paths>
        </pipeline>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Get Invoice Headers"
      DTS:CreationName="SSIS.Pipeline.3"
      DTS:Description="Data Flow Task"
      DTS:DTSID="{B8E6800D-D19B-47C5-9305-A66DF40D46F1}"
      DTS:ExecutableType="SSIS.Pipeline.3"
      DTS:LocaleID="-1"
      DTS:ObjectName="Get Invoice Headers"
      DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:Variables />
      <DTS:LoggingOptions
        DTS:FilterKind="0"
        DTS:LoggingMode="1">
        <DTS:Property
          DTS:DataType="8"
          DTS:Name="EventFilter">1,7,OnError</DTS:Property>
        <DTS:Property
          DTS:EventName="OnError"
          DTS:Name="ColumnFilter">
          <DTS:Property
            DTS:Name="Computer">-1</DTS:Property>
          <DTS:Property
            DTS:Name="Operator">-1</DTS:Property>
          <DTS:Property
            DTS:Name="SourceName">-1</DTS:Property>
          <DTS:Property
            DTS:Name="SourceID">-1</DTS:Property>
          <DTS:Property
            DTS:Name="ExecutionID">-1</DTS:Property>
          <DTS:Property
            DTS:Name="MessageText">-1</DTS:Property>
          <DTS:Property
            DTS:Name="DataBytes">-1</DTS:Property>
        </DTS:Property>
      </DTS:LoggingOptions>
      <DTS:ObjectData>
        <pipeline
          version="1">
          <components>
            <component
              refId="Package\Get Invoice Headers\Flat File Destination Not Excluded"
              componentClassID="{8DA75FED-1B7C-407D-B2AD-2B24209CCCA4}"
              contactInfo="Flat File Destination;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;0"
              description="Flat File Destination"
              localeId="1033"
              name="Flat File Destination Not Excluded">
              <properties>
                <property
                  dataType="System.Boolean"
                  description="Specifies whether the data will overwrite or append to the destination file."
                  name="Overwrite">true</property>
                <property
                  dataType="System.Null"
                  description="Specifies the text to write to the destination file before any data is written."
                  expressionType="Notify"
                  name="Header" />
              </properties>
              <connections>
                <connection
                  refId="Package\Get Invoice Headers\Flat File Destination Not Excluded.Connections[FlatFileConnection]"
                  connectionManagerID="Package.ConnectionManagers[HeaderFileNotExcluded]"
                  connectionManagerRefId="Package.ConnectionManagers[HeaderFileNotExcluded]"
                  name="FlatFileConnection" />
              </connections>
              <inputs>
                <input
                  refId="Package\Get Invoice Headers\Flat File Destination Not Excluded.Inputs[Flat File Destination Input]"
                  hasSideEffects="true"
                  name="Flat File Destination Input">
                  <inputColumns>
                    <inputColumn
                      refId="Package\Get Invoice Headers\Flat File Destination Not Excluded.Inputs[Flat File Destination Input].Columns[Identifier]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="1"
                      cachedName="Identifier"
                      externalMetadataColumnId="Package\Get Invoice Headers\Flat File Destination Not Excluded.Inputs[Flat File Destination Input].ExternalColumns[Identifier]"
                      lineageId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[Identifier]" />
                    <inputColumn
                      refId="Package\Get Invoice Headers\Flat File Destination Not Excluded.Inputs[Flat File Destination Input].Columns[RESTAURANT_NUM]"
                      cachedDataType="i4"
                      cachedName="RESTAURANT_NUM"
                      externalMetadataColumnId="Package\Get Invoice Headers\Flat File Destination Not Excluded.Inputs[Flat File Destination Input].ExternalColumns[RESTAURANT_NUM]"
                      lineageId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[RESTAURANT_NUM]" />
                    <inputColumn
                      refId="Package\Get Invoice Headers\Flat File Destination Not Excluded.Inputs[Flat File Destination Input].Columns[SUPPLIER_NUM]"
                      cachedDataType="i4"
                      cachedName="SUPPLIER_NUM"
                      externalMetadataColumnId="Package\Get Invoice Headers\Flat File Destination Not Excluded.Inputs[Flat File Destination Input].ExternalColumns[SUPPLIER_NUM]"
                      lineageId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[SUPPLIER_NUM]" />
                    <inputColumn
                      refId="Package\Get Invoice Headers\Flat File Destination Not Excluded.Inputs[Flat File Destination Input].Columns[PERIOD_NUM]"
                      cachedDataType="i4"
                      cachedName="PERIOD_NUM"
                      externalMetadataColumnId="Package\Get Invoice Headers\Flat File Destination Not Excluded.Inputs[Flat File Destination Input].ExternalColumns[PERIOD_NUM]"
                      lineageId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[PERIOD_NUM]" />
                    <inputColumn
                      refId="Package\Get Invoice Headers\Flat File Destination Not Excluded.Inputs[Flat File Destination Input].Columns[WEEK_NUM]"
                      cachedDataType="i4"
                      cachedName="WEEK_NUM"
                      externalMetadataColumnId="Package\Get Invoice Headers\Flat File Destination Not Excluded.Inputs[Flat File Destination Input].ExternalColumns[WEEK_NUM]"
                      lineageId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[WEEK_NUM]" />
                    <inputColumn
                      refId="Package\Get Invoice Headers\Flat File Destination Not Excluded.Inputs[Flat File Destination Input].Columns[INVOICE_TOTAL]"
                      cachedDataType="cy"
                      cachedName="INVOICE_TOTAL"
                      externalMetadataColumnId="Package\Get Invoice Headers\Flat File Destination Not Excluded.Inputs[Flat File Destination Input].ExternalColumns[INVOICE_TOTAL]"
                      lineageId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[INVOICE_TOTAL]" />
                    <inputColumn
                      refId="Package\Get Invoice Headers\Flat File Destination Not Excluded.Inputs[Flat File Destination Input].Columns[INVOICE_DATE]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="20"
                      cachedName="INVOICE_DATE"
                      externalMetadataColumnId="Package\Get Invoice Headers\Flat File Destination Not Excluded.Inputs[Flat File Destination Input].ExternalColumns[INVOICE_DATE]"
                      lineageId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[INVOICE_DATE]" />
                    <inputColumn
                      refId="Package\Get Invoice Headers\Flat File Destination Not Excluded.Inputs[Flat File Destination Input].Columns[INVOICE_NUM]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="30"
                      cachedName="INVOICE_NUM"
                      externalMetadataColumnId="Package\Get Invoice Headers\Flat File Destination Not Excluded.Inputs[Flat File Destination Input].ExternalColumns[INVOICE_NUM]"
                      lineageId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[INVOICE_NUM]" />
                  </inputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Get Invoice Headers\Flat File Destination Not Excluded.Inputs[Flat File Destination Input].ExternalColumns[Identifier]"
                      codePage="1252"
                      dataType="str"
                      length="1"
                      name="Identifier" />
                    <externalMetadataColumn
                      refId="Package\Get Invoice Headers\Flat File Destination Not Excluded.Inputs[Flat File Destination Input].ExternalColumns[RESTAURANT_NUM]"
                      dataType="i4"
                      name="RESTAURANT_NUM" />
                    <externalMetadataColumn
                      refId="Package\Get Invoice Headers\Flat File Destination Not Excluded.Inputs[Flat File Destination Input].ExternalColumns[INVOICE_NUM]"
                      codePage="1252"
                      dataType="str"
                      length="30"
                      name="INVOICE_NUM" />
                    <externalMetadataColumn
                      refId="Package\Get Invoice Headers\Flat File Destination Not Excluded.Inputs[Flat File Destination Input].ExternalColumns[SUPPLIER_NUM]"
                      dataType="i4"
                      name="SUPPLIER_NUM" />
                    <externalMetadataColumn
                      refId="Package\Get Invoice Headers\Flat File Destination Not Excluded.Inputs[Flat File Destination Input].ExternalColumns[PERIOD_NUM]"
                      dataType="i4"
                      name="PERIOD_NUM" />
                    <externalMetadataColumn
                      refId="Package\Get Invoice Headers\Flat File Destination Not Excluded.Inputs[Flat File Destination Input].ExternalColumns[WEEK_NUM]"
                      dataType="i4"
                      name="WEEK_NUM" />
                    <externalMetadataColumn
                      refId="Package\Get Invoice Headers\Flat File Destination Not Excluded.Inputs[Flat File Destination Input].ExternalColumns[INVOICE_TOTAL]"
                      dataType="cy"
                      name="INVOICE_TOTAL" />
                    <externalMetadataColumn
                      refId="Package\Get Invoice Headers\Flat File Destination Not Excluded.Inputs[Flat File Destination Input].ExternalColumns[INVOICE_DATE]"
                      codePage="1252"
                      dataType="str"
                      length="20"
                      name="INVOICE_DATE" />
                  </externalMetadataColumns>
                </input>
              </inputs>
            </component>
            <component
              refId="Package\Get Invoice Headers\Lookup"
              componentClassID="{671046B0-AA63-4C9F-90E4-C06E0B710CE3}"
              contactInfo="Lookup;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;6"
              description="Joins additional columns to the data flow by looking up values in a table. For example, join to the 'employee id' column the employees table to get 'hire date' and 'employee name'. We recommend this transformation when the lookup table can fit into memory."
              name="Lookup"
              usesDispositions="true"
              version="6">
              <properties>
                <property
                  dataType="System.String"
                  description="Specifies the SQL statement that generates the lookup table."
                  expressionType="Notify"
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor, Microsoft.DataTransformationServices.Controls, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91">select * from [MenuLink].[INT037JDEReference]</property>
                <property
                  dataType="System.String"
                  description="Specifies a SQL statement that uses parameters to generate the lookup table."
                  expressionType="Notify"
                  name="SqlCommandParam"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor, Microsoft.DataTransformationServices.Controls, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91">select * from (select * from [MenuLink].[INT037JDEReference]) [refTable]
where [refTable].[JDESupplierInvoiceID] = ? and [refTable].[JDESupplierID] = ?</property>
                <property
                  dataType="System.Int32"
                  description="Specifies the type of connection used to access the reference dataset."
                  name="ConnectionType"
                  typeConverter="LookupConnectionType">0</property>
                <property
                  dataType="System.Int32"
                  description="Specifies the cache type of the lookup table."
                  name="CacheType"
                  typeConverter="CacheType">0</property>
                <property
                  dataType="System.Int32"
                  description="Specifies how the Lookup transformation handles rows without matching entries in the reference data set."
                  name="NoMatchBehavior"
                  typeConverter="LookupNoMatchBehavior">1</property>
                <property
                  dataType="System.Int32"
                  description="Specifies the percentage of the cache that is allocated for rows with no matching entries in the reference dataset."
                  name="NoMatchCachePercentage">0</property>
                <property
                  dataType="System.Int32"
                  description="Maximum Memory Usage for Reference Cache on a 32 bit platform."
                  name="MaxMemoryUsage">25</property>
                <property
                  dataType="System.Int64"
                  description="Maximum Memory Usage for Reference Cache on a 64 bit platform."
                  name="MaxMemoryUsage64">25</property>
                <property
                  dataType="System.String"
                  description="Indicates whether to reference metadata in an XML format."
                  name="ReferenceMetadataXml">&lt;referenceMetadata&gt;&lt;referenceColumns&gt;&lt;referenceColumn name="JDESupplierID" dataType="DT_I4" length="0" precision="0" scale="0" codePage="0"/&gt;&lt;referenceColumn name="JDESupplierInvoiceID" dataType="DT_STR" length="50" precision="0" scale="0" codePage="1252"/&gt;&lt;/referenceColumns&gt;&lt;/referenceMetadata&gt;</property>
                <property
                  containsID="true"
                  dataType="System.String"
                  description="Specifies the list of lineage identifiers that map to the parameters that the SQL statement in the SQLCommand property uses. Entries in the list are separated by semicolons."
                  name="ParameterMap">#{Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[INVOICE_NUM]};#{Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[SUPPLIER_NUM]};</property>
                <property
                  dataType="System.Int32"
                  description="Specifies the column code page to use when code page information is unavailable from the data source."
                  name="DefaultCodePage">1252</property>
                <property
                  dataType="System.Boolean"
                  description="Determines whether duplicate keys in the reference data should be treated as errors when full cache mode is used."
                  name="TreatDuplicateKeysAsError">false</property>
              </properties>
              <connections>
                <connection
                  refId="Package\Get Invoice Headers\Lookup.Connections[OleDbConnection]"
                  connectionManagerID="Package.ConnectionManagers[HQ-FinSQL-01.Interfaces.SSISUser]"
                  connectionManagerRefId="Package.ConnectionManagers[HQ-FinSQL-01.Interfaces.SSISUser]"
                  description="Connection manager used to access lookup data."
                  name="OleDbConnection" />
              </connections>
              <inputs>
                <input
                  refId="Package\Get Invoice Headers\Lookup.Inputs[Lookup Input]"
                  name="Lookup Input">
                  <inputColumns>
                    <inputColumn
                      refId="Package\Get Invoice Headers\Lookup.Inputs[Lookup Input].Columns[SUPPLIER_NUM]"
                      cachedDataType="i4"
                      cachedName="SUPPLIER_NUM"
                      lineageId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[SUPPLIER_NUM]">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Specifies the column in the reference table that a column joins."
                          name="JoinToReferenceColumn">JDESupplierID</property>
                        <property
                          dataType="System.Null"
                          description="Specifies the column in the reference table from which a column is copied."
                          name="CopyFromReferenceColumn" />
                      </properties>
                    </inputColumn>
                    <inputColumn
                      refId="Package\Get Invoice Headers\Lookup.Inputs[Lookup Input].Columns[INVOICE_NUM]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="30"
                      cachedName="INVOICE_NUM"
                      lineageId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[INVOICE_NUM]">
                      <properties>
                        <property
                          dataType="System.String"
                          description="Specifies the column in the reference table that a column joins."
                          name="JoinToReferenceColumn">JDESupplierInvoiceID</property>
                        <property
                          dataType="System.Null"
                          description="Specifies the column in the reference table from which a column is copied."
                          name="CopyFromReferenceColumn" />
                      </properties>
                    </inputColumn>
                  </inputColumns>
                  <externalMetadataColumns />
                </input>
              </inputs>
              <outputs>
                <output
                  refId="Package\Get Invoice Headers\Lookup.Outputs[Lookup Match Output]"
                  errorOrTruncationOperation="Lookup"
                  exclusionGroup="1"
                  name="Lookup Match Output"
                  synchronousInputId="Package\Get Invoice Headers\Lookup.Inputs[Lookup Input]">
                  <externalMetadataColumns />
                </output>
                <output
                  refId="Package\Get Invoice Headers\Lookup.Outputs[Lookup No Match Output]"
                  description="The Lookup output that handles rows with no matching entries in the reference dataset. Use this output when the NoMatchBehavior property is set to &quot;Send rows with no matching entries to the no match output.&quot;"
                  exclusionGroup="1"
                  name="Lookup No Match Output"
                  synchronousInputId="Package\Get Invoice Headers\Lookup.Inputs[Lookup Input]">
                  <externalMetadataColumns />
                </output>
                <output
                  refId="Package\Get Invoice Headers\Lookup.Outputs[Lookup Error Output]"
                  exclusionGroup="1"
                  isErrorOut="true"
                  name="Lookup Error Output"
                  synchronousInputId="Package\Get Invoice Headers\Lookup.Inputs[Lookup Input]">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Get Invoice Headers\Lookup.Outputs[Lookup Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Get Invoice Headers\Lookup.Outputs[Lookup Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Get Invoice Headers\Lookup.Outputs[Lookup Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Get Invoice Headers\Lookup.Outputs[Lookup Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
            <component
              refId="Package\Get Invoice Headers\OLE DB Source 1"
              componentClassID="{165A526D-D5DE-47FF-96A6-F8274C19826B}"
              contactInfo="OLE DB Source;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;7"
              description="OLE DB Source"
              name="OLE DB Source 1"
              usesDispositions="true"
              version="7">
              <properties>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                  name="CommandTimeout">0</property>
                <property
                  dataType="System.String"
                  description="Specifies the name of the database object used to open a rowset."
                  name="OpenRowset"></property>
                <property
                  dataType="System.String"
                  description="Specifies the variable that contains the name of the database object used to open a rowset."
                  name="OpenRowsetVariable"></property>
                <property
                  dataType="System.String"
                  description="The SQL command to be executed."
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor, Microsoft.DataTransformationServices.Controls, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91">-- Invoice Header Query for INT037/047

-- Declare and set Store and Subperiod variables
DECLARE @StoreID varchar(3)
DECLARE @Subperiod int

SET @StoreID = '652'
SET @Subperiod = 794

-- Declare Invoice Header table variable
DECLARE @InvoiceHeader TABLE (
								hIdentifier varchar(1),
								hStoreID varchar(15),
								hInvoiceID varchar(30),
								hSupplierID varchar(20),
								hPeriod int,
								hWeekNum int,
								hInvoiceAmount money,
								hCalculatedInvoiceAmount money,
								hInvoiceDate varchar(20)
								)

-- Declare Invoice Detail table variable
DECLARE @InvoiceDetail TABLE (
								dIdentifier varchar(1),
								dStoreID varchar(15),
								dInvoiceID varchar(30),
								dLineDesc varchar(100),
								dVendorItemID varchar(60),
								dLineNumber int,
								dQuantity decimal(10,2),
								dUnitPrice decimal(10,2),
								dExtendedPrice decimal(10,2),
								dGLAccount int,
								dSubperiod varchar(10),
								dInvoiceDate datetime
								)


-- Populate header table variable with all invoice headers for the specified subperiod
INSERT INTO @InvoiceHeader (	hIdentifier,
								hStoreID,
								hInvoiceID,
								hSupplierID,
								hPeriod,
								hWeekNum,
								hInvoiceAmount,
								hInvoiceDate
								)
	SELECT	'I',
			StoreID,
			InvoiceID,
			VendorID,
			ReportingPeriod#,
			[Week],
			convert(money, TotalAmountPayable) as [INVOICE_TOTAL],
			convert(varchar(15),InvoiceDate, 101) as [INVOICE_DATE]
	FROM	ST_InvoiceHeaders 
	WHERE	SubPeriod = @Subperiod AND StoreID = @StoreID

-- Populate detail table variable with all invoice line item detail for the specified subperiod
INSERT INTO @InvoiceDetail
	SELECT	'I',
			StoreID,
			InvoiceID,
			dLineDesc = CASE RawMaterialCatNum
				WHEN 1015000 THEN 'Payroll Cash Clearing'
				WHEN 1065000 THEN 'Employee Advance - Merc. Comm.'
				WHEN 2100000 THEN 'Gift Certificate Sales'
				WHEN 5100000 THEN 'Meat'
				WHEN 5110000 THEN 'Hamburger'
				WHEN 5120000 THEN 'Poultry'
				WHEN 5130000 THEN 'Seafood'
				WHEN 5140000 THEN 'Produce'
				WHEN 5150000 THEN 'French Fries'
				WHEN 5160000 THEN 'Canned/Dry Goods'
				WHEN 5170000 THEN 'Bread'
				WHEN 5180000 THEN 'Dairy'
				WHEN 5185000 THEN 'Cheese'
				WHEN 5190000 THEN 'Fry Oil'
				WHEN 5199000 THEN 'Rebates'
				WHEN 5210000 THEN 'Liquor'
				WHEN 5220000 THEN 'Wine'
				WHEN 5230000 THEN 'Draft Beer'
				WHEN 5240000 THEN 'Bottled Beer'
				WHEN 5250000 THEN 'Bar Consumables'
				WHEN 6050000 THEN 'Team Member Meetings'
				WHEN 6255000 THEN 'Laundry Allowance'
				WHEN 7010000 THEN 'Kitchen Supplies'
				WHEN 7020000 THEN 'Restaurant Supplies'
				WHEN 7030000 THEN 'Glassware'
				WHEN 7040000 THEN 'China'
				WHEN 7050000 THEN 'Paper Supplies'
				WHEN 7060000 THEN 'Cleaning Supplies'
				WHEN 7070000 THEN 'Office Supplies'
				WHEN 7110000 THEN 'Laundry'
				WHEN 7120000 THEN 'Uniforms'
				WHEN 7140000 THEN 'Guest Complaints'
				WHEN 7150000 THEN 'Telephone'
				WHEN 7160000 THEN 'Dues and Subs'
				WHEN 7170000 THEN 'Recruitment Adv.'
				WHEN 7180000 THEN 'Cash Over and Short'
				WHEN 7190000 THEN 'Theft Loss &amp; Walkouts'
				WHEN 7200000 THEN 'Postage &amp; Freight'
				WHEN 7220000 THEN 'Janitorial &amp; Plant Maint.'
				WHEN 7221000 THEN 'Indoor Cleaning'
				WHEN 7222000 THEN 'Outdoor - Cleaning &amp; Landscape'
				WHEN 7222000 THEN 'Outdoor Cleaning &amp; Landscape'
				WHEN 7223000 THEN 'Pest Control'
				WHEN 7240000 THEN 'Travel'
				WHEN 7250000 THEN 'Warehousing &amp; Storage'
				WHEN 7310000 THEN 'R &amp; M - Building/FFE RPM'
				WHEN 7320000 THEN 'Preventive Maint Contracts'
				WHEN 7325000 THEN 'R &amp; M - Local Services'
				WHEN 7330000 THEN 'Comp &amp; Office Equip Maint.'
				WHEN 7440000 THEN 'Garbage'
				WHEN 7510000 THEN 'Leased Music'
				WHEN 7525000 THEN 'Plants Purchased'
				WHEN 7530000 THEN 'Bad Debts'
				WHEN 7540000 THEN 'Licenses'
				WHEN 7545000 THEN 'Security Services'
				WHEN 7550000 THEN 'City Business Tax'
				WHEN 7560000 THEN 'Small Equipment'
				WHEN 7580000 THEN 'Professional Services'
				WHEN 7590000 THEN 'Bank Charges'
				WHEN 7610000 THEN 'Marketing Supplies'
				WHEN 7620000 THEN 'Gift Cert - Promo'
				WHEN 7630000 THEN 'Local Store Marketing'
				WHEN 7630100 THEN 'Local Store Mktg Fundraiser'
				WHEN 7630100 THEN 'Local Store Mktg Fundraising'
				WHEN 7640000 THEN 'Advertising Contribribution'
				WHEN 7640000 THEN 'Advertising Contribution'
				WHEN 7660000 THEN 'Discount/Coupons - Rest'
				WHEN 7670000 THEN 'Discount/Coupons - Corp'
				WHEN 7710000 THEN 'Mercantile'
				WHEN 7720000 THEN 'Telephone Income'
				WHEN 7740000 THEN 'Amusement Income'
				WHEN 7750000 THEN 'Misc Income'
				WHEN 7820000 THEN 'Parking'
				WHEN 7840000 THEN 'Real Estate Taxes'
				WHEN 7870000 THEN 'Leased Equipment'
				WHEN 7900000 THEN 'Amort - Leasehold Imp'
				WHEN 7905000 THEN 'RRI Fee Expense'
				WHEN 7910000 THEN 'Amort - Organization'
				END,
			VendorItemID,
			convert(int, (convert(decimal(17,12), InvoiceLineItem#))),
			round((convert(decimal(38,30), QuantityReceived)), 2),
			round((convert(decimal(38,30), PurchaseUnitPrice)), 2),
			round((convert(decimal(38,30), ExtendedPrice)), 2),
			convert(int, RawMaterialCatNum),
			Subperiod,
			InvoiceDate
	FROM	ST_InvoiceDetails 
	WHERE	SubPeriod = @Subperiod AND StoreID = @StoreID

-- Calculate the invoice header total from the extended price of the line items in the detail

-- Calculate totals for each invoice
UPDATE @InvoiceHeader
SET hCalculatedInvoiceAmount = (	SELECT sum(dExtendedPrice) 
									FROM @InvoiceDetail
									WHERE hStoreID = dStoreID
										AND hInvoiceID = dInvoiceID
										AND hInvoiceDate = dInvoiceDate
								)

-- Remove Records with NULL hCalculatedInvoiceAmount
DELETE  FROM @InvoiceHeader
WHERE hCalculatedInvoiceAmount IS NULL AND hInvoiceID LIKE 'P%'


-- Final dataset
SELECT	hIdentifier as [Identifier],
		convert(int, hStoreID) as [RESTAURANT_NUM],
		hInvoiceID as [INVOICE_NUM],
		convert(int, hSupplierID) as [SUPPLIER_NUM],
		hPeriod as [PERIOD_NUM],
		hWeekNum as [WEEK_NUM],
		hCalculatedInvoiceAmount as [INVOICE_TOTAL],
		hInvoiceDate as [INVOICE_DATE]
 FROM	@InvoiceHeader</property>
                <property
                  dataType="System.String"
                  description="The variable that contains the SQL command to be executed."
                  name="SqlCommandVariable">User::HeadersQuery</property>
                <property
                  dataType="System.Int32"
                  description="Specifies the column code page to use when code page information is unavailable from the data source."
                  name="DefaultCodePage">1252</property>
                <property
                  dataType="System.Boolean"
                  description="Forces the use of the DefaultCodePage property value when describing character data."
                  name="AlwaysUseDefaultCodePage">false</property>
                <property
                  dataType="System.Int32"
                  description="Specifies the mode used to access the database."
                  name="AccessMode"
                  typeConverter="AccessMode">3</property>
                <property
                  dataType="System.String"
                  description="The mappings between the parameters in the SQL command and variables."
                  name="ParameterMapping"></property>
              </properties>
              <connections>
                <connection
                  refId="Package\Get Invoice Headers\OLE DB Source 1.Connections[OleDbConnection]"
                  connectionManagerID="Package.ConnectionManagers[cronus\cronussql2000.MLHQ]"
                  connectionManagerRefId="Package.ConnectionManagers[cronus\cronussql2000.MLHQ]"
                  description="The OLE DB runtime connection used to access the database."
                  name="OleDbConnection" />
              </connections>
              <outputs>
                <output
                  refId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output]"
                  name="OLE DB Source Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[Identifier]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[Identifier]"
                      length="1"
                      lineageId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[Identifier]"
                      name="Identifier"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[RESTAURANT_NUM]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[RESTAURANT_NUM]"
                      lineageId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[RESTAURANT_NUM]"
                      name="RESTAURANT_NUM"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[INVOICE_NUM]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[INVOICE_NUM]"
                      length="30"
                      lineageId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[INVOICE_NUM]"
                      name="INVOICE_NUM"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[SUPPLIER_NUM]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[SUPPLIER_NUM]"
                      lineageId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[SUPPLIER_NUM]"
                      name="SUPPLIER_NUM"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[INVOICE_DATE]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[INVOICE_DATE]"
                      length="20"
                      lineageId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[INVOICE_DATE]"
                      name="INVOICE_DATE"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[PERIOD_NUM]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[PERIOD_NUM]"
                      lineageId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[PERIOD_NUM]"
                      name="PERIOD_NUM"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[WEEK_NUM]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[WEEK_NUM]"
                      lineageId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[WEEK_NUM]"
                      name="WEEK_NUM"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[INVOICE_TOTAL]"
                      dataType="cy"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[INVOICE_TOTAL]"
                      lineageId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[INVOICE_TOTAL]"
                      name="INVOICE_TOTAL"
                      truncationRowDisposition="FailComponent" />
                  </outputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[Identifier]"
                      codePage="1252"
                      dataType="str"
                      length="1"
                      name="Identifier" />
                    <externalMetadataColumn
                      refId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[RESTAURANT_NUM]"
                      dataType="i4"
                      name="RESTAURANT_NUM" />
                    <externalMetadataColumn
                      refId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[INVOICE_NUM]"
                      codePage="1252"
                      dataType="str"
                      length="30"
                      name="INVOICE_NUM" />
                    <externalMetadataColumn
                      refId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[SUPPLIER_NUM]"
                      dataType="i4"
                      name="SUPPLIER_NUM" />
                    <externalMetadataColumn
                      refId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[INVOICE_DATE]"
                      codePage="1252"
                      dataType="str"
                      length="20"
                      name="INVOICE_DATE" />
                    <externalMetadataColumn
                      refId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[PERIOD_NUM]"
                      dataType="i4"
                      name="PERIOD_NUM" />
                    <externalMetadataColumn
                      refId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[WEEK_NUM]"
                      dataType="i4"
                      name="WEEK_NUM" />
                    <externalMetadataColumn
                      refId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[INVOICE_TOTAL]"
                      dataType="cy"
                      name="INVOICE_TOTAL" />
                  </externalMetadataColumns>
                </output>
                <output
                  refId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Error Output]"
                  isErrorOut="true"
                  name="OLE DB Source Error Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[Identifier]"
                      codePage="1252"
                      dataType="str"
                      length="1"
                      lineageId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[Identifier]"
                      name="Identifier" />
                    <outputColumn
                      refId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[RESTAURANT_NUM]"
                      dataType="i4"
                      lineageId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[RESTAURANT_NUM]"
                      name="RESTAURANT_NUM" />
                    <outputColumn
                      refId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[INVOICE_NUM]"
                      codePage="1252"
                      dataType="str"
                      length="30"
                      lineageId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[INVOICE_NUM]"
                      name="INVOICE_NUM" />
                    <outputColumn
                      refId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[SUPPLIER_NUM]"
                      dataType="i4"
                      lineageId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[SUPPLIER_NUM]"
                      name="SUPPLIER_NUM" />
                    <outputColumn
                      refId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[PERIOD_NUM]"
                      dataType="i4"
                      lineageId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[PERIOD_NUM]"
                      name="PERIOD_NUM" />
                    <outputColumn
                      refId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[WEEK_NUM]"
                      dataType="i4"
                      lineageId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[WEEK_NUM]"
                      name="WEEK_NUM" />
                    <outputColumn
                      refId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[INVOICE_TOTAL]"
                      dataType="cy"
                      lineageId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[INVOICE_TOTAL]"
                      name="INVOICE_TOTAL" />
                    <outputColumn
                      refId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[INVOICE_DATE]"
                      codePage="1252"
                      dataType="str"
                      length="20"
                      lineageId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[INVOICE_DATE]"
                      name="INVOICE_DATE" />
                    <outputColumn
                      refId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
          </components>
          <paths>
            <path
              refId="Package\Get Invoice Headers.Paths[Lookup No Match Output]"
              endId="Package\Get Invoice Headers\Flat File Destination Not Excluded.Inputs[Flat File Destination Input]"
              name="Lookup No Match Output"
              startId="Package\Get Invoice Headers\Lookup.Outputs[Lookup No Match Output]" />
            <path
              refId="Package\Get Invoice Headers.Paths[OLE DB Source Output]"
              endId="Package\Get Invoice Headers\Lookup.Inputs[Lookup Input]"
              name="OLE DB Source Output"
              startId="Package\Get Invoice Headers\OLE DB Source 1.Outputs[OLE DB Source Output]" />
          </paths>
        </pipeline>
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint]"
      DTS:CreationName=""
      DTS:DTSID="{EDB4115D-72D0-4D54-9CF1-C227BC3DE58E}"
      DTS:From="Package\Get Invoice Details"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint"
      DTS:To="Package\Get Invoice Headers" />
  </DTS:PrecedenceConstraints>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="sql11">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="169,42"
          Id="Package\Get Invoice Details"
          TopLeft="154,85" />
        <NodeLayout
          Size="176,42"
          Id="Package\Get Invoice Headers"
          TopLeft="157,192" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint]"
          TopLeft="241.75,127">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,65"
              Start="0,0"
              End="0,57.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,57.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
  <TaskHost
    design-time-name="Package\Get Invoice Details">
    <LayoutInfo>
      <GraphLayout
        Capacity="8" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="221,42"
          Id="Package\Get Invoice Details\Remove Existing JDE Invoices"
          TopLeft="341,144" />
        <NodeLayout
          Size="157,42"
          Id="Package\Get Invoice Details\Detail Recordset"
          TopLeft="149,67" />
        <NodeLayout
          Size="191,42"
          Id="Package\Get Invoice Details\Detail File Not Excluded"
          TopLeft="666,253" />
        <EdgeLayout
          Id="Package\Get Invoice Details.Paths[OLE DB Source Output]"
          TopLeft="227.5,109">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="224,35"
              Start="0,0"
              End="224,27.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,13.5" />
                  <mssgle:CubicBezierSegment
                    Point1="0,13.5"
                    Point2="0,17.5"
                    Point3="4,17.5" />
                  <mssgle:LineSegment
                    End="220,17.5" />
                  <mssgle:CubicBezierSegment
                    Point1="220,17.5"
                    Point2="224,17.5"
                    Point3="224,21.5" />
                  <mssgle:LineSegment
                    End="224,27.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Get Invoice Details.Paths[Lookup No Match Output]"
          TopLeft="487,186">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="274.5,67"
              Start="0,0"
              End="274.5,59.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,23.088948787062" />
                  <mssgle:CubicBezierSegment
                    Point1="0,23.088948787062"
                    Point2="0,27.088948787062"
                    Point3="4,27.088948787062" />
                  <mssgle:LineSegment
                    End="270.5,27.088948787062" />
                  <mssgle:CubicBezierSegment
                    Point1="270.5,27.088948787062"
                    Point2="274.5,27.088948787062"
                    Point3="274.5,31.088948787062" />
                  <mssgle:LineSegment
                    End="274.5,59.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="82.44361328125,32.088948787062,111.6127734375,11.609375"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Get Invoice Details\Remove Existing JDE Invoices">
    <Properties>
      <Property>
        <Name>OverwriteParamsSQLProp</Name>
        <Value
          type="q2:boolean">false</Value>
      </Property>
      <Property>
        <Name>UsedTableName</Name>
        <Value
          type="q3:string">[MenuLink].[INT037JDEReference]</Value>
      </Property>
      <Property>
        <Name>TableInfoObjectType</Name>
        <Value
          type="q4:int">0</Value>
      </Property>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\Get Invoice Details\Detail Recordset">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\Get Invoice Headers">
    <LayoutInfo>
      <GraphLayout
        Capacity="8" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml" xmlns:mssgm="clr-namespace:Microsoft.SqlServer.Graph.Model;assembly=Microsoft.SqlServer.Graph">
        <NodeLayout
          Size="160,42"
          Id="Package\Get Invoice Headers\OLE DB Source 1"
          TopLeft="458,89" />
        <NodeLayout
          Size="114,42"
          Id="Package\Get Invoice Headers\Lookup"
          TopLeft="525,221" />
        <NodeLayout
          Size="238,42"
          Id="Package\Get Invoice Headers\Flat File Destination Not Excluded"
          TopLeft="793,286" />
        <EdgeLayout
          Id="Package\Get Invoice Headers.Paths[OLE DB Source Output]"
          TopLeft="538,131">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="44,90"
              Start="0,0"
              End="44,82.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,41" />
                  <mssgle:CubicBezierSegment
                    Point1="0,41"
                    Point2="0,45"
                    Point3="4,45" />
                  <mssgle:LineSegment
                    End="40,45" />
                  <mssgle:CubicBezierSegment
                    Point1="40,45"
                    Point2="44,45"
                    Point3="44,49" />
                  <mssgle:LineSegment
                    End="44,82.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Get Invoice Headers.Paths[Lookup No Match Output]"
          TopLeft="582,263">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="330,23"
              Start="0,0"
              End="330,15.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,7.5" />
                  <mssgle:CubicBezierSegment
                    Point1="0,7.5"
                    Point2="0,11.5"
                    Point3="4,11.5" />
                  <mssgle:LineSegment
                    End="326,11.5" />
                  <mssgle:CubicBezierSegment
                    Point1="326,11.5"
                    Point2="330,11.5"
                    Point3="330,15.5" />
                  <mssgle:LineSegment
                    End="330,15.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <mssgm:EdgeLabel
              BoundingBox="110.19361328125,16.5,111.6127734375,11.609375"
              RelativePosition="Any" />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Get Invoice Headers\OLE DB Source 1">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\Get Invoice Headers\Lookup">
    <Properties>
      <Property>
        <Name>OverwriteParamsSQLProp</Name>
        <Value
          type="q2:boolean">false</Value>
      </Property>
      <Property>
        <Name>UsedTableName</Name>
        <Value
          type="q3:string">[MenuLink].[INT037JDEReference]</Value>
      </Property>
      <Property>
        <Name>TableInfoObjectType</Name>
        <Value
          type="q4:int">0</Value>
      </Property>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>